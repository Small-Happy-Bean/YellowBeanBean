(function(u,p){typeof exports=="object"&&typeof module<"u"?p(require("phaser")):typeof define=="function"&&define.amd?define(["phaser"],p):(u=typeof globalThis<"u"?globalThis:u||self,p(u.Phaser))})(this,function(u){"use strict";function p(c){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(c){for(const e in c)if(e!=="default"){const a=Object.getOwnPropertyDescriptor(c,e);Object.defineProperty(t,e,a.get?a:{enumerable:!0,get:()=>c[e]})}}return t.default=c,Object.freeze(t)}const n=p(u),B={HAPPY_BE_LAZY:0,JUST_WANT_IT:1,DOUBLE_BEANS_RUN:2,ALL_YOU_FROZEN:3,CYBER_IKUZO:4,RED_TEMPER_BOMB:5,AKAMI_MAGIC:6},C=[{HAPPY_BE_LAZY:"偷懒了~嘻嘻~",JUST_WANT_IT:"有钱真好啊~",DOUBLE_BEANS_RUN:"双人成行的美好时光~",ALL_YOU_FROZEN:"冻结时间！",CYBER_IKUZO:"勇者，出击！",RED_TEMPER_BOMB:"红温了！",AKAMI_MAGIC:"阿卡莱斯魔术，启动！"},{HAPPY_BE_LAZY:"Enjoy lazy time~",JUST_WANT_IT:"I am money love~",DOUBLE_BEANS_RUN:"Be Friend Forever!",ALL_YOU_FROZEN:"Freezing Time!",CYBER_IKUZO:"Cyber BEAMMMM!",RED_TEMPER_BOMB:"BOOM!",AKAMI_MAGIC:"AKAMI MAGIC! START!"},{HAPPY_BE_LAZY:"眠たいなぁ～",JUST_WANT_IT:"お金、欲しい！",DOUBLE_BEANS_RUN:"いつでも仲良し！",ALL_YOU_FROZEN:"これは、風吹雪",CYBER_IKUZO:"勇者、行くぞ！",RED_TEMPER_BOMB:"怒るだよ！",AKAMI_MAGIC:"アカミマジック！スタート！"}],h=[{ForPanelNumber:{fontSize:36,fontFamily:"Impact"},ForTopPanelText:{fontSize:36,fontFamily:"AlibabaFangYuan"},ForBottomPanelText:{fontSize:36,fontFamily:"AlibabaFangYuan"},ForShopNumber:{fontSize:30,fontFamily:"Impact"},ForShopText:{fontSize:24,fontFamily:"AlibabaFangYuan"},ForShopTitleBefore:{fontSize:36,fontFamily:"AlibabaFangYuan",backgroundColor:"transparent",color:"white"},ForShopTitleAfter:{fontSize:36,fontFamily:"AlibabaFangYuan",backgroundColor:"white",color:"#3b2820"},ForMerchantWords:{fontSize:24,fontFamily:"AlibabaFangYuan",color:"#000000"},ForHangWords:{fontSize:28,fontFamily:"AlibabaFangYuan",backgroundColor:"white",color:"#3b2820"},ForAboutusText:{fontSize:24,fontFamily:"AlibabaFangYuan"},ForEstiamtionTitle:{fontSize:36,fontFamily:"AlibabaFangYuan"},ForEstimationText:{fontSize:30,fontFamily:"AlibabaFangYuan",color:"#ffe945"},ForItemUsed:{fontSize:36,fontFamily:"AlibabaFangYuan"},ForAudioDisplay:{fontSize:24,fontFamily:"AlibabaFangYuan"}},{ForPanelNumber:{fontSize:36,fontFamily:"Impact"},ForTopPanelText:{fontSize:32,fontFamily:"Comic Sans MS"},ForBottomPanelText:{fontSize:24,fontFamily:"Comic Sans MS",padding:4},ForShopNumber:{fontSize:30,fontFamily:"Impact"},ForShopText:{fontSize:16,fontFamily:"Comic Sans MS"},ForShopTitleBefore:{fontSize:20,fontFamily:"Comic Sans MS",backgroundColor:"transparent",color:"white"},ForShopTitleAfter:{fontSize:20,fontFamily:"Comic Sans MS",backgroundColor:"white",color:"#3b2820"},ForMerchantWords:{fontSize:24,fontFamily:"Comic Sans MS",color:"#000000"},ForHangWords:{fontSize:28,fontFamily:"Comic Sans MS",backgroundColor:"white",color:"#3b2820"},ForAboutusText:{fontSize:24,fontFamily:"Comic Sans MS"},ForEstiamtionTitle:{fontSize:22,padding:6,fontFamily:"Comic Sans MS"},ForEstimationText:{fontSize:28,fontFamily:"Comic Sans MS",color:"#ffe945"},ForItemUsed:{fontSize:36,fontFamily:"Comic Sans MS",padding:8}},{ForPanelNumber:{fontSize:36,fontFamily:"Impact"},ForTopPanelText:{fontSize:32,fontFamily:"HGGothicE"},ForBottomPanelText:{fontSize:30,fontFamily:"HGGothicE",padding:4},ForShopNumber:{fontSize:30,fontFamily:"Impact"},ForShopText:{fontSize:22,fontFamily:"HGGothicE"},ForShopTitleBefore:{fontSize:36,fontFamily:"HGGothicE",backgroundColor:"transparent",color:"white"},ForShopTitleAfter:{fontSize:36,fontFamily:"HGGothicE",backgroundColor:"white",color:"#3b2820"},ForMerchantWords:{fontSize:24,fontFamily:"HGGothicE",color:"black"},ForHangWords:{fontSize:28,fontFamily:"HGGothicE",backgroundColor:"white",color:"#3b2820"},ForAboutusText:{fontSize:24,fontFamily:"HGGothicE"},ForEstiamtionTitle:{fontSize:32,fontFamily:"HGGothicE",padding:4},ForEstimationText:{fontSize:30,fontFamily:"HGGothicE",color:"#ffe945"},ForItemUsed:{fontSize:32,fontFamily:"HGGothicE"}}],A=["语言","LANG","言語設定"],I=[["中文","英语","日语"],["CN","EN","JP"],["中国語","英語","日本語"]],M=["关于","ABOUT","関して"],E=["谨以纪念黄豆小组的愉快时光。",`To Remember Happy Days 
in Yellow Bean Team.`,`「豆」チームに楽しい日々を
記念する為に…`],_=["黄豆海鲜市场","YellowBean SeaFood Shop","表・豆豆屋"],O=["黑豆咩咩市场","BlackBean Maa-Maa Shop","裏・豆豆屋"],G=["点击道具即可购买！记得有钱！","Click the item to purchase in~","クリックして買える、お金あったら！"],F=["点击商品即可入手捏~有钱的话~","Click the power to purchase in~","クリックしてゲットだ～お金足りだか？"],L=["持有道具","Current Items","持ちアイテム"],b=[["持有黄豆","持有方块","持有音效"],["Current Bean","Current Block","Current Sound"],["持ち豆","持ちブロック","持ち音"]],x=[[`人生像浓豆浆
一样一团浆糊......`,`好玩吗？这不好
玩，单纯是你太
无聊了而已。`,`我们不过是
舞台上的摆设
，想扔就扔......`,`我想抽却不
能抽你~没有
你世界只剩死寂~`,`买道具要适度
！打完一把就走！`,`我顶飞你啊！
`],[`Life is just a
 mess like
 bean salad`,`Do you think
 this game
 interesting?
 Perhaps not!`,`We are NPCs,
 remembered 
 or forgotten...`,`Do you feel
 better today?`,`Special items
 can be good,
 but cost money!`,"***Filterd***"],[`悲劇を避ける
為に、今から
悪いことしないで
ほうがいいよ．．．`,`いい世、来い？
かもしれませんね。`,`苦しいけど、
出来るなら
出来るまで
生きている．．．`,`一生で忘れない、
そんな話、
ちょっと悲しみを
感じるちゃん．．．`,`8時間眠できる
はいい文明だぞ！`,`好き人いなら
告白しよう？`]],w=[[`哼！居然被你
发现了咩咩市场！
买了皮肤也不能
让你强大哦！`,`给了足够的钱
才能开放好玩的
东西哦！
再玩几下吧~`,`苦痛的生活也要
坚强起来啊......
活下去吧亲。`],[`I don't think
 how you deed
 any relation
 with the cover...`,`No enough coin~ 
How dare you
 to open one?`,`Already go so
 far... Be brave,
 and may
 you good life~`],[`ある時、実力は
使い物の形とは
関係ない、かも
しれませんね。`,`お金が足りて、
面白いことを
開放されでき
だなぁ！`,`悲しいですか？
諦めないで、
人生はまだ
終わらない！`]],N=["豆币不够诶！","Coin no enough!","コイン、足りないだぞ？"],D=[`豆币不够
可以去挣哦？`,"Maybe you need more coins~",`コイン足りない
よ？頑張ってね！`],v=[`该去咩咩市场找
安慰哦？你这
没礼貌的家伙......`,`So rude! Go
 Maa-Maa Shop
 for comforts,
 please?`,`失礼よお前．．．
裏・豆豆屋に
ほうがいいぞ．．．`],H=[`愿你的内心
如梦境般安宁......
我亲爱的勇者
大人......`,`May you heart
 peace like dream.
 My Dear Mr.
 Adventurer...`,`心の中、夢のよう
な、穏やかなに、
いいですよね．．．
我らの勇者様．．．`],y=["默认",`吉吉国
的谜之声`,`草场最
可爱的一集`],R=[["偷懒是好文明","好想要有钱啊","俩黄豆跑得快","塞可罗吉之雪","勇者光炮出击","红温的爆爆爆","阿卡莱斯魔术"],["HAPPY_BE_LAZY","JUST_WANT_IT","DOUBLE_BEANS_RUN","ALL_YOU_FROZEN","CYBER_IKUZO","RED_TEMPER_BOMB","AKAMI_MAGIC"],["眠たいね～","千兆円欲しい！","お二つは走るよ","凍るだよ？","勇者、行くぞ！","怒るなぁ俺！","アカミマジック"]],k=["豆币","Coin","コイン"],z=["得分","Score","スコア"],W=["黄豆","Bean","豆"],Y=["道具","Item","アイテム"],U=["历史最高","History Highest","歴史最高"],j=["本次得分","Current Score","今回点数"],g={BALL_SIZE:.09,BALL_SPEED:2e3,SHAPES_PER_LINE:8,SHAPES_ALL_LINES:10,MAX_SHAPES_NUM_PER_LINE:4,EXTRA_BEAN_PROBABILITY:80,PREDICTIVE_SHOOTING_TRAIL_LENGTH:2e3,SPECIAL_ITEM_SIZE:.1,SPECIAL_ITEM_PROBABILTIY:20},l={WAITING_FOR_SHOOTING:0,PLAYER_AIMING:1,BALL_FLYING:2,BALL_COLLPSING:3,RECYCLING_FOR_NEXT:4,BOOM_FLYING:5,BEAM_FLYING:6},P=["0x8a2c24","0xffdd6e","0x66c204","0x03aba8","0x0099bf","0x8a3b94","0x82003d"],V=[{0:["杂鱼杂鱼~才打这么点~","YOU DIED（菜就多练）","会认可这样草率的结局吗......"],100:["这样啊......","旅途才刚刚开始哦~","要加油哦，勇者大人！"],300:["要奖励你一块小蛋糕吗？","有时候不要太勉强自己哦？",`变强可不是一天
就能完成的事情呢。`],500:[`点个火吧。
让我们休息一会儿...`,`回过头来，
没有后悔药了呢。`,"我们会打败那里的风车吗？"],1e3:["据说新王会在信念中诞生哦？","已经走了这么远了啊......",`很厉害了啊，
像那迫近的风暴.....`],3e3:["心怀着希望前进吧。","真乃勇士也......","强大，无需多言。"],5e3:["好像解锁了神秘的地方？","传说，出现了啊。",`辛苦了。
为您献上一杯卡布奇诺~`],1e4:["在此见证新王的诞生......",`已经到这里了，
还要战斗下去吗？`,"或许不会是最后的结局......"]},{0:["Better to take it seriously?","YOU DIED (Joke)","Not mind ending so fast?..."],100:["So it goes...","Trip just begins here~","Fighting, Mr.Adventurer!"],300:["A piece of cake for you?",`Sometimes do not do
 what out of your ability...`,"Rome is not built in a day..."],500:[`Lit a fire.
 Let's take a break.`,`Look back,
 no chance for regret.`,`Do you think we could
 defeat the windmill there?`],1e3:[`It's said, New Lord would
 be born in the belief, right?`,`Already gone so far...
 Brave man...`,`Like the storm approaching,
 in my eyes...`],3e3:["Go ahead! With hope in heart.","You brave adventurer...","So strong. No more words..."],5e3:["Somewhere unlocked?","Legend, appears now...",`Would you like a cup of Latte?
 Just for you.`],1e4:[`Here. Witness
 the born of the New Lord!`,`Feel tired?
 If so, may you good rest...`,`Adventure would not end
 here? Maybe... `]},{0:["雑魚雑魚～弱いかもね？","YOU DIED（大噓）",`こんな草な結局、
受け取っていい？`],100:["そうですね．．．","旅は、ただ始まるぞ？","頑張てね！勇者様！"],300:[`おケーキ、食べ欲しい？
これ、差しれ～`,`ある時、
無理しないでください。`,`強いになることは、
一日中できないですよ～`],500:[`焚き火をつけて、
少々休みましょう．．．`,`振り返って、
後悔の機会がないぞ？`,`我らは、あそこの風車を
倒すこと、できるか？`],1e3:[`新しいの王様は、
信念の中で現れるかもよ？`,"もう、ここにいるか．．．",`すごいな．．．
嵐のように．．．`],3e3:[`希望を持って、
前に歩き行こう．．．`,"さすが勇者様だ．．．",`強さを、
もう言えない．．．`],5e3:[`ある場所は
開放でしょうか．．．`,"伝説が、始まる．．．",`お疲れ様です。モカ
コーヒー、いかがですか？`],1e4:[`ここに、
新しいの王様がある。`,"ちょっと、疲れた．．．",`ここは、
最後の結局ですか？`]}];class K extends n.Scene{constructor(){super("GamePlay")}preload(){this.load.image("bean0","../assets/images/beans/bean0.png"),this.load.image("bean1","../assets/images/beans/bean1.png"),this.load.image("bean2","../assets/images/beans/bean2.png"),this.load.image("block0","../assets/images/blocks/block0.png"),this.load.image("block1","../assets/images/blocks/block1.png"),this.load.image("block2","../assets/images/blocks/block2.png"),this.load.image("point","../assets/images/point.png"),this.load.image("beampoint","../assets/images/beampoint.png"),this.load.image("item0","../assets/images/special_items/item0.png"),this.load.image("item1","../assets/images/special_items/item1.png"),this.load.image("item2","../assets/images/special_items/item2.png"),this.load.image("item3","../assets/images/special_items/item3.png"),this.load.image("item4","../assets/images/special_items/item4.png"),this.load.image("item5","../assets/images/special_items/item5.png"),this.load.image("item6","../assets/images/special_items/item6.png"),this.load.image("coin","../assets/images/coin.png"),this.load.image("lightcoin","../assets/images/lightCoin.png"),this.load.image("panel","../assets/images/panel.png"),this.load.image("home","../assets/images/icons/home.png"),this.load.image("play","../assets/images/icons/play.png"),this.load.image("shop","../assets/images/icons/shop.png"),this.load.image("pause","../assets/images/icons/pause.png"),this.load.image("setting","../assets/images/icons/setting.png"),this.load.image("restart","../assets/images/icons/restart.png"),this.load.image("close","../assets/images/icons/close.png"),this.load.image("sound","../assets/images/icons/sound.png"),this.load.image("nosound","../assets/images/icons/nosound.png"),this.load.audio("bgm","../assets/audios/bgm.mp3"),this.load.audio("ding","../assets/audios/ding.mp3"),this.load.audio("forblock0","../assets/audios/forblock/block0.mp3"),this.load.audio("forblock1","../assets/audios/forblock/block1.mp3"),this.load.audio("forblock2","../assets/audios/forblock/block2.mp3"),this.load.audio("forbeam0","../assets/audios/forbeam/beam0.mp3"),this.load.audio("forbeam1","../assets/audios/forbeam/beam1.mp3"),this.load.audio("forbeam2","../assets/audios/forbeam/beam2.mp3"),this.load.audio("forboom0","../assets/audios/forboom/boom0.mp3"),this.load.audio("forboom1","../assets/audios/forboom/boom1.mp3"),this.load.audio("forboom2","../assets/audios/forboom/boom2.mp3")}create(){this.beanIndex=localStorage.getItem("bean")!=null?localStorage.getItem("bean").replace("bean",""):0,this.blockIndex=localStorage.getItem("block")!=null?localStorage.getItem("block").replace("block",""):0,this.audioIndex=localStorage.getItem("audio")!=null?localStorage.getItem("audio").replace("audio",""):0,this.langIndex=localStorage.getItem("lang")!=null?localStorage.getItem("lang"):0,this.isBgmPlay=localStorage.getItem("isBgmPlay")!=null?JSON.parse(localStorage.getItem("isBgmPlay")):!1,this.isSePlay=localStorage.getItem("isSePlay")!=null?JSON.parse(localStorage.getItem("isSePlay")):!0,this.gameOver=!1,this.coins=localStorage.getItem("coin")!=null?JSON.parse(localStorage.getItem("coin")):0,this.score=0,this.highestHistoryScore=localStorage.getItem("historyHighest")?localStorage.getItem("historyHighest"):0,this.gameState=l.WAITING_FOR_SHOOTING,this.specialItemKeys=Object.keys(B),this.estimationWord=Object(V[this.langIndex]),this.isFrozen=!1,this.isGreedy=!1,this.isDouble=!1,this.isBeamTime=!1,this.isBoomTime=!1,this.audioPlayer=document.querySelector(".bgm-audio"),this.isAnyModalOpen=!1,this.estimatedLevel=0,this.level=0,this.beanCount=1,this.recycledBlocks=[],this.blockSize=game.config.width/g.SHAPES_PER_LINE,this.gameFieldHeight=this.blockSize*g.SHAPES_ALL_LINES,this.emptySpace=game.config.height-this.gameFieldHeight,this.physics.world.setBounds(0,this.emptySpace/2,game.config.width,this.gameFieldHeight),this.blockGroup=this.physics.add.group(),this.beanGroup=this.physics.add.group(),this.extraBeanGroup=this.physics.add.group(),this.specialItemGroup=this.physics.add.group(),this.currentSpecialItemGroup=this.physics.add.group(),localStorage.getItem("myItems")!=null&&localStorage.getItem("myItems").split(",").forEach((o,r)=>{let d=this.currentSpecialItemGroup.create(100*(r+1)+200,1200,o).setScale(.3).setDepth(1).setInteractive({useHandCursor:!0});d.on("pointerdown",()=>{this.selectSpecialItem(o);let m=this.currentSpecialItemGroup.getChildren(),S=m.indexOf(d),X=m.slice(S+1,m.length);this.tweens.add({targets:X,x:"-=100",duration:300}),d.destroy()})}),this.tweens.add({targets:this.currentSpecialItemGroup.getChildren(),y:"-=100",duration:1500,repeat:0,ease:"back.out"}),this.topPanel=this.add.sprite(game.config.width/2,0,"panel"),this.topPanel.displayWidth=game.config.width,this.topPanel.displayHeight=this.emptySpace/2,this.topPanel.setOrigin(.5,0),this.pauseButton=this.add.image(60,100,"pause").setScale(.6).setInteractive({useHandCursor:!0}),this.settingButton=this.add.image(game.config.width-60,100,"setting").setScale(.6).setInteractive({useHandCursor:!0}),this.coinExample=this.add.image(130,0,"coin").setScale(.2),this.tweens.add({targets:this.coinExample,y:100,duration:1500,repeat:0,ease:"back.out"}),this.coinText=this.add.text(160,0,k[this.langIndex],h[this.langIndex].ForTopPanelText),this.coinData=this.add.text(200,0,this.coins,h[this.langIndex].ForPanelNumber),this.scoreText=this.add.text(game.config.width-260,0,z[this.langIndex],h[this.langIndex].ForTopPanelText),this.scoreData=this.add.text(game.config.width-220,0,this.score,h[this.langIndex].ForPanelNumber),this.tweens.add({targets:[this.coinText,this.scoreText],y:80,duration:1500,repeat:0,ease:"back.out"}),this.tweens.add({targets:[this.coinData,this.scoreData],y:130,duration:1500,repeat:0,ease:"back.out"}),this.bottomPanel=this.add.sprite(game.config.width/2,game.config.height,"panel"),this.bottomPanel.displayWidth=game.config.width,this.bottomPanel.displayHeight=this.emptySpace/2,this.bottomPanel.setOrigin(.5,1),this.beanExample=this.add.image(100,game.config.height+20,"bean"+this.beanIndex).setScale(.3).setDepth(1),this.beanData=this.add.text(180,game.config.height,this.beanCount,h[this.langIndex].ForPanelNumber);let t=this.add.circle(100,game.config.height+20,48,3876896),e=this.add.circle(300,game.config.height+20,48,3876896),a=this.add.circle(400,game.config.height+20,48,3876896),s=this.add.circle(500,game.config.height+20,48,3876896);this.tweens.add({targets:[t,e,a,s,this.beanExample,this.beanData],y:"-=120",duration:1500,repeat:0,ease:"back.out"}),this.beanText=this.add.text(60,game.config.height,W[this.langIndex],h[this.langIndex].ForBottomPanelText).setDepth(2),this.itemText=this.add.text(360,game.config.height,Y[this.langIndex],h[this.langIndex].ForBottomPanelText).setDepth(2),this.tweens.add({targets:[this.beanText,this.itemText],y:"-=200",duration:1500,repeat:0,ease:"back.out"}),this.ballSize=game.config.width*g.BALL_SIZE,this.trajectoryGraphics=this.add.graphics(),this.addBean(game.config.width/2,game.config.height-this.bottomPanel.displayHeight-this.ballSize/2,!1),this.shootPointGroup=this.add.group();for(let i=0;i<12;i++){let o=this.add.image(game.config.width/2,game.config.height-this.bottomPanel.displayHeight-32,"point").setScale(.1).setDepth(-1);this.shootPointGroup.add(o)}this.shootPointGroup.setVisible(!1),this.shootBoomGroup=this.add.group();for(let i=0;i<8;i++){let o=this.add.image(game.config.width/2,game.config.height-this.bottomPanel.displayHeight-32,"point").setScale(.3).setDepth(-1);this.shootBoomGroup.add(o)}this.shootBoomGroup.setVisible(!1),this.shootBeamGroup=this.add.group();for(let i=0;i<16;i++){let o=this.add.image(game.config.width/2,game.config.height-this.bottomPanel.displayHeight-32,"beampoint").setScale(.5).setDepth(-1);this.shootBeamGroup.add(o)}this.shootBeamGroup.setVisible(!1),this.addShapeLine(),this.pauseButton.on("pointerdown",()=>{this.createOverlayMask(),this.showPauseModal()}),this.settingButton.on("pointerdown",()=>{this.createOverlayMask(),this.showSettingModal()}),this.input.on("pointerdown",this.aimingShapes,this),this.input.on("pointerup",this.shootBean,this),this.input.on("pointermove",this.adjustShooting,this),this.input.on("dragstart",this.aimingShapes,this),this.input.on("dragend",this.shootBean,this),this.input.on("drag",this.adjustShooting,this),this.physics.world.on("worldbounds",this.checkBeanBoundCollision,this)}update(){(this.gameState==l.BALL_COLLPSING||this.gameState==l.BALL_FLYING&&this.landedBalls==this.beanGroup.getChildren().length)&&(this.gameState==l.BALL_FLYING?this.gameState=l.BALL_COLLPSING:(this.gameState=l.RECYCLING_FOR_NEXT,this.isFrozen||(this.moveBlocks(),this.moveExtraBeans(),this.moveSpecialItems()),this.firstBallToLand!=null&&this.moveBeans(),this.resetStates())),this.gameState==l.BALL_FLYING&&(this.handleBeanVsShape(),this.handleBeanVsExtra(),this.handleBeanVsSpecialItem()),this.gameState==l.BOOM_FLYING&&this.handleBoomVsShape(),this.gameState==l.BEAM_FLYING&&this.handleBeamVsAll()}addShape(t,e,a,s){let i=a?this.recycledBlocks.shift():this.blockGroup.create(t,e,"block"+this.blockIndex);if(i.displayWidth=this.blockSize,i.displayHeight=this.blockSize,i.value=this.level,i.row=1,i.setTint(s),a)i.x=t,i.y=e,i.text.setText(i.value),i.text.x=i.x,i.text.y=i.y,i.setVisible(!0),i.text.setVisible(!0),this.blockGroup.add(i);else{let o=this.add.text(i.x,i.y,i.value,{font:"normal 32px Impact",align:"center",color:"#ffffff"});o.setOrigin(.5),i.text=o}i.body.immovable=!0}addBean(t,e,a){let s=a?this.extraBeanGroup.create(t,e,"bean"+this.beanIndex):this.beanGroup.create(t,e,"bean"+this.beanIndex);s.displayWidth=this.ballSize,s.displayHeight=this.ballSize,s.body.setCircle(128),s.body.setBounce(1,1),a&&(s.row=1,s.collected=!1),s.body.collideWorldBounds=!0,s.body.onWorldBounds=!0}addBoomOrBeam(t,e,a,s){a&&(this.boom=this.beanGroup.create(t,e,"item5"),this.boom.displayWidth=this.ballSize*2,this.boom.displayHeight=this.ballSize*2,this.boom.body.setCircle(128),this.boom.body.setBounce(1,1),this.boom.body.collideWorldBounds=!0,this.boom.body.onWorldBounds=!0),s&&(this.beam=this.beanGroup.create(t,e,"item4"),this.beam.displayWidth=this.ballSize*4,this.beam.displayHeight=this.ballSize*4,this.beam.body.setCircle(128),this.beam.body.setBounce(1,1),this.beam.body.collideWorldBounds=!0,this.beam.body.onWorldBounds=!0)}addSpecialItem(t,e){let s="item"+n.Math.Between(0,this.specialItemKeys.length-1),i=this.specialItemGroup.create(t,e,s);i.displayWidth=this.ballSize,i.displayHeight=this.ballSize,i.body.setCircle(128),i.body.setBounce(1,1),i.body.collideWorldBounds=!0,i.body.onWorldBounds=!0}addShapeLine(){this.level++;let t=[],e=P[Math.floor(Math.random()*P.length)],a=n.Math.Between(0,100)<g.EXTRA_BEAN_PROBABILITY,s=n.Math.Between(0,100)<g.SPECIAL_ITEM_PROBABILTIY;for(let i=0;i<g.MAX_SHAPES_NUM_PER_LINE;i++){let o=n.Math.Between(0,g.SHAPES_PER_LINE-1);t.indexOf(o)==-1&&(t.push(o),a?(a=!1,this.addBean(o*this.blockSize+this.blockSize/2,this.blockSize/2+this.emptySpace/2,!0)):s?(s=!1,this.addSpecialItem(o*this.blockSize+this.blockSize/2,this.blockSize/2+this.emptySpace/2)):this.recycledBlocks.length==0?this.addShape(o*this.blockSize+this.blockSize/2,this.blockSize/2+this.emptySpace/2,!1,e):this.addShape(o*this.blockSize+this.blockSize/2,this.blockSize/2+this.emptySpace/2,!0,e)),this.fieldSegments=[];let r=new n.Geom.Rectangle(0,this.emptySpace/2,game.config.width,this.gameFieldHeight);this.addToFieldSegments(r),n.Actions.Call(this.blockGroup.getChildren(),function(d){let m=d.getBounds();this.addToFieldSegments(m)},this)}}getBallPosition(){let t=this.beanGroup.getChildren();return new n.Geom.Point(t[0].x,t[0].y)}aimingShapes(){this.gameState==l.WAITING_FOR_SHOOTING&&(this.legalAngleOfFire=!1,this.gameState=l.PLAYER_AIMING)}adjustShooting(t){this.gameState==l.PLAYER_AIMING&&(t.y-t.downY>10?(this.legalAngleOfFire=!0,this.direction=n.Math.Angle.Between(t.x,t.y,t.downX,t.downY),this.shootPointGroup.setVisible(!0),this.tweens.addCounter({from:0,to:40,duration:1e3,repeat:-1,onUpdate:a=>{this.shootPointGroup.getChildren().forEach((s,i)=>{let o=i*40+a.getValue();s.setPosition(this.beanGroup.getChildren()[0].x+o*Math.cos(this.direction),this.beanGroup.getChildren()[0].y+o*Math.sin(this.direction))})}})):(this.legalAngleOfFire=!1,this.trajectoryGraphics.clear()))}adjustBoomShooting(t){this.gameState==l.PLAYER_AIMING&&(t.y-t.downY>10?(this.legalAngleOfFire=!0,this.direction=n.Math.Angle.Between(t.x,t.y,t.downX,t.downY),this.shootBoomGroup.setVisible(!0),this.tweens.addCounter({from:0,to:60,duration:1e3,repeat:-1,onUpdate:a=>{this.shootBoomGroup.getChildren().forEach((s,i)=>{let o=i*60+a.getValue();s.setPosition(this.beanGroup.getChildren()[0].x+o*Math.cos(this.direction),this.beanGroup.getChildren()[0].y+o*Math.sin(this.direction))})}})):(this.legalAngleOfFire=!1,this.trajectoryGraphics.clear()))}adjustBeamShooting(t){this.gameState==l.PLAYER_AIMING&&(t.y-t.downY>10?(this.legalAngleOfFire=!0,this.direction=n.Math.Angle.Between(t.x,t.y,t.downX,t.downY),this.shootBeamGroup.setVisible(!0),this.tweens.addCounter({from:0,to:40,duration:1e3,repeat:-1,onUpdate:a=>{this.shootBeamGroup.getChildren().forEach((s,i)=>{let o=i*40+a.getValue();s.setPosition(this.beanGroup.getChildren()[0].x+o*Math.cos(this.direction),this.beanGroup.getChildren()[0].y+o*Math.sin(this.direction)),s.setRotation(Math.cos(this.direction))})}})):(this.legalAngleOfFire=!1,this.trajectoryGraphics.clear()))}addToFieldSegments(t){this.fieldSegments.push(t.getLineA()),this.fieldSegments.push(t.getLineB()),this.fieldSegments.push(t.getLineC()),this.fieldSegments.push(t.getLineD())}shootBean(){this.gameState==l.PLAYER_AIMING&&(this.trajectoryGraphics.clear(),this.shootPointGroup.setVisible(!1),this.legalAngleOfFire?(this.gameState=l.BALL_FLYING,this.landedBalls=0,this.beanGroup.getChildren().forEach((function(t,e){this.time.addEvent({delay:100*e,callbackScope:this,callback:function(){t.body.setVelocity(g.BALL_SPEED*Math.cos(this.direction),g.BALL_SPEED*Math.sin(this.direction))}})}).bind(this))):this.gameState=l.WAITING_FOR_SHOOTING)}shootBoom(){this.gameState==l.PLAYER_AIMING&&(this.trajectoryGraphics.clear(),this.shootBoomGroup.setVisible(!1),this.legalAngleOfFire?(this.gameState=l.BOOM_FLYING,this.time.addEvent({delay:100,callbackScope:this,callback:function(){this.boom.body.setVelocity(g.BALL_SPEED*Math.cos(this.direction),g.BALL_SPEED*Math.sin(this.direction))}})):this.gameState=l.WAITING_FOR_SHOOTING)}shootBeam(){this.gameState==l.PLAYER_AIMING&&(this.trajectoryGraphics.clear(),this.shootBeamGroup.setVisible(!1),this.legalAngleOfFire?(this.gameState=l.BEAM_FLYING,this.time.addEvent({delay:100,callbackScope:this,callback:function(){this.beam.body.setVelocity(g.BALL_SPEED*Math.cos(this.direction)*2,g.BALL_SPEED*Math.sin(this.direction)*2)}})):this.gameState=l.WAITING_FOR_SHOOTING)}checkBeanBoundCollision(t,e,a,s,i){a&&this.gameState==l.BALL_FLYING&&(t.setVelocity(0),this.landedBalls++,this.landedBalls==1&&(this.firstBallToLand=t))}checkBoomBoundCollision(t,e,a,s,i){(e&&this.gameState==l.BOOM_FLYING||s&&this.gameState==l.BOOM_FLYING||i&&this.gameState==l.BOOM_FLYING)&&(this.boom.destroy(),setTimeout(()=>{this.beanGroup.setVisible(!0),this.gameState=l.WAITING_FOR_SHOOTING,this.resetInput()},300))}checkBeamBoundCollision(t,e,a,s,i){(e&&this.gameState==l.BEAM_FLYING||s&&this.gameState==l.BEAM_FLYING||i&&this.gameState==l.BEAM_FLYING)&&(this.beam.destroy(),setTimeout(()=>{this.beanGroup.setVisible(!0),this.gameState=l.WAITING_FOR_SHOOTING,this.resetInput()},300))}moveBlocks(){this.tweens.add({targets:this.blockGroup.getChildren(),props:{y:{getEnd:function(t){return t.y+t.displayHeight}}},callbackScope:this,onUpdate:function(t,e){e.text.y=e.y},onComplete:function(){if(this.gameState=l.WAITING_FOR_SHOOTING,n.Actions.Call(this.blockGroup.getChildren(),function(t){t.row++,t.row==g.SHAPES_ALL_LINES&&(this.gameOver=!0)},this),this.addShapeLine(),this.gameOver){this.input.off("pointermove"),this.createOverlayMask(),this.showRestartModal(),this.score>this.highestHistoryScore&&localStorage.setItem("historyHighest",this.score),localStorage.setItem("coin",this.coins);let t=[];this.currentSpecialItemGroup.getChildren().forEach(e=>{t.push(e.texture.key)}),localStorage.setItem("myItems",t)}},duration:500,ease:"Cubic.easeInOut"})}moveBeans(){this.tweens.add({targets:this.beanGroup.getChildren(),x:this.firstBallToLand.gameObject.x,duration:300,ease:"Cubic.easeInOut"})}moveExtraBeans(){n.Actions.Call(this.extraBeanGroup.getChildren(),function(t){t.row==g.blockLines&&(t.collected=!0)}),this.tweens.add({targets:this.extraBeanGroup.getChildren(),props:{x:{getEnd:function(t){return t.collected?t.scene.firstBallToLand.gameObject.x:t.x}},y:{getEnd:function(t){return t.collected?t.scene.firstBallToLand.gameObject.y:t.y+t.scene.blockSize}}},callbackScope:this,onComplete:function(){n.Actions.Call(this.extraBeanGroup.getChildren(),function(t){t.collected?(this.extraBeanGroup.remove(t),this.beanGroup.add(t),t.body.collideWorldBounds=!0,t.body.onWorldBounds=!0,t.body.setBounce(1,1),this.beanCount=this.beanGroup.children.entries.length,this.beanData.text=this.beanCount):t.row++},this)},duration:300,ease:"Cubic.easeInOut"})}moveSpecialItems(){this.tweens.add({targets:this.specialItemGroup.getChildren(),props:{x:{getEnd:function(t){return t.collected?t.scene.firstBallToLand.gameObject.x:t.x}},y:{getEnd:function(t){return t.collected?t.scene.firstBallToLand.gameObject.y:t.y+t.scene.blockSize}}},callbackScope:this,onComplete:function(){n.Actions.Call(this.specialItemGroup.getChildren(),function(t){t.collected?this.specialItemGroup.remove(t):t.row++},this)},duration:300,ease:"Cubic.easeInOut"})}handleBeanVsShape(){this.physics.world.collide(this.beanGroup,this.blockGroup,function(t,e){this.isSePlay&&this.sound.play("ding"),this.isDouble?e.value-=2:e.value--,this.score+=1,e.value<=0?(this.recycledBlocks.push(e),this.blockGroup.remove(e),e.visible=!1,e.text.visible=!1,this.isSePlay&&this.sound.play("forblock"+this.audioIndex),this.coins=this.isGreedy?this.coins+2:this.coins+1,this.coinData.setText(this.coins)):e.text.setText(e.value),this.scoreData.setText(this.score)},null,this)}handleBoomVsShape(){this.physics.world.collide(this.boom,this.blockGroup,function(t,e){this.isSePlay&&this.sound.add("forboom"+this.audioIndex,{volume:.6}).play(),this.tweens.add({targets:t,scale:.6,duration:100,onComplete:()=>{this.score+=e.value,this.recycledBlocks.push(e),this.blockGroup.remove(e),e.visible=!1,e.text.visible=!1,this.scoreData.setText(this.score),this.coins=this.isGreedy?this.coins+2:this.coins+1,this.coinData.setText(this.coins)}})},null,this)}handleBeamVsAll(){this.physics.world.overlap(this.beam,this.blockGroup,function(t,e){this.isSePlay&&this.sound.add("forbeam"+this.audioIndex,{volume:.4}).play(),this.score+=e.value,this.recycledBlocks.push(e),this.blockGroup.remove(e),e.visible=!1,e.text.visible=!1,e.text.setText(e.value),this.scoreData.setText(this.score)},null,this),this.physics.world.overlap(this.beam,this.extraBeanGroup,function(t,e){this.extraBeanGroup.remove(e),e.destroy()},null,this),this.physics.world.overlap(this.beam,this.specialItemGroup,function(t,e){this.specialItemGroup.remove(e),e.destroy()},null,this)}handleBeanVsExtra(){this.physics.world.overlap(this.beanGroup,this.extraBeanGroup,function(t,e){e.collected=!0,this.tweens.add({targets:e,y:game.config.height-this.bottomPanel.displayHeight-e.displayHeight/2,duration:200,ease:"Cubic.easeOut"})},null,this)}handleBeanVsSpecialItem(){this.physics.world.overlap(this.beanGroup,this.specialItemGroup,function(t,e){let a=this.currentSpecialItemGroup.getChildren(),s=a.length;if(this.specialItemGroup.remove(e),this.currentSpecialItemGroup.add(e),e.setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.selectSpecialItem(e.texture.key);let i=this.currentSpecialItemGroup.getChildren(),o=i.indexOf(e),r=i.slice(o+1,i.length);this.tweens.add({targets:r,x:"-=100",duration:300}),this.currentSpecialItemGroup.remove(e),e.destroy()}),s<3&&(e.setPosition(100*(s+1)+200,1100,0,0),e.setScale(.3)),s>=3){e.setPosition(500,game.config.height,0,0),e.setScale(.3);let i=a.slice(0,a.length-3),o=a.slice(a.length-3,a.length-1);this.tweens.add({targets:i,y:"+=180",duration:300,onComplete:()=>{this.currentSpecialItemGroup.remove(i);for(let r of i)r.destroy()}}),this.tweens.add({targets:o,x:"-=100",duration:300}),this.tweens.add({targets:e,y:"-=100",duration:300})}},null,this)}eraseBlockLine(){let t=this.blockGroup.getChildren(),e=[];if(this.addSpecialItemTweens("HAPPY_BE_LAZY",game.config.width/2-100,game.config.height/2,"+=80"),t.length!=0){let a=t[0].row;t.forEach(i=>{i.row===a&&e.push(i)}),e.forEach(i=>{i.destroy(),i.text.destroy()});let s=this.add.image(0,this.emptySpace/2+this.blockSize*a-this.blockSize/2,"block"+this.blockIndex).setScale(.4).setTint(16774781);s.displayWidth=this.blockSize,s.displayHeight=this.blockSize,this.tweens.add({targets:s,x:game.config.width,duration:500,onComplete:()=>{s.destroy()}})}}greedyTime(){this.isGreedy=!0,this.coinExample.setTexture("lightcoin"),this.addSpecialItemTweens("JUST_WANT_IT",game.config.width/2-100,game.config.height/2,"+=80")}doubleShooting(){this.isDouble=!0,this.beanExample.setTexture("item2"),this.addSpecialItemTweens("DOUBLE_BEANS_RUN",game.config.width/2-180,game.config.height/2,"+=80")}freezeBlockLine(){this.isFrozen=!0,this.blockGroup.getChildren().forEach(t=>{t.setTint(6393850)}),this.addSpecialItemTweens("ALL_YOU_FROZEN",game.config.width/2-80,game.config.height/2,"+=80")}beamTime(){this.isBoomTime&&(this.isBoomTime=!1,this.boom.destroy()),this.addSpecialItemTweens("CYBER_IKUZO",game.config.width/2-200,game.config.height/2,"+=80"),this.beanGroup.setVisible(!1),this.isBeamTime=!0,this.input.off("pointermove",this.adjustShooting,this),this.input.on("pointermove",this.adjustBeamShooting,this),this.input.off("pointerup",this.shootBean,this),this.input.on("pointerup",this.shootBeam,this),this.physics.world.off("worldbounds",this.checkBeanBoundCollision,this),this.physics.world.on("worldbounds",this.checkBeamBoundCollision,this),this.firstBallTempLocate=this.beanGroup.getChildren()[0],this.addBoomOrBeam(this.firstBallTempLocate.x,this.firstBallTempLocate.y,!1,!0)}boomTime(){this.isBeamTime&&(this.isBeamTime=!1,this.beam.destroy()),this.beanGroup.setVisible(!1),this.addSpecialItemTweens("RED_TEMPER_BOMB",game.config.width/2-100,game.config.height/2,"+=80"),this.isBoomTime=!0,this.input.off("pointermove",this.adjustShooting,this),this.input.on("pointermove",this.adjustBoomShooting,this),this.input.off("pointerup",this.shootBean,this),this.input.on("pointerup",this.shootBoom,this),this.physics.world.off("worldbounds",this.checkBeanBoundCollision,this),this.physics.world.on("worldbounds",this.checkBoomBoundCollision,this),this.firstBallTempLocate=this.beanGroup.getChildren()[0],this.addBoomOrBeam(this.firstBallTempLocate.x,this.firstBallTempLocate.y,!0,!1)}pickRandomSpecialItem(){this.addSpecialItemTweens("AKAMI_MAGIC",game.config.width/2-180,game.config.height/2-120,"+=0");let e="item"+n.Math.Between(0,this.specialItemKeys.length-2);this.selectSpecialItem(e)}resetStates(){this.isFrozen=!1,this.isGreedy=!1,this.isDouble=!1,this.isBoomTime=!1,this.isBeamTime=!1,this.resetInput(),this.gameState=l.WAITING_FOR_SHOOTING,this.coinExample.setTexture("coin"),this.beanExample.setTexture("bean"+this.beanIndex)}resetInput(){this.input.off("pointermove"),this.input.off("pointerup"),this.input.on("pointermove",this.adjustShooting,this),this.input.on("pointerup",this.shootBean,this),this.physics.world.off("worldbounds"),this.physics.world.on("worldbounds",this.checkBeanBoundCollision,this)}selectSpecialItem(t){switch(t){case"item0":this.eraseBlockLine();break;case"item1":this.greedyTime();break;case"item2":this.doubleShooting();break;case"item3":this.freezeBlockLine();break;case"item4":this.beamTime();break;case"item5":this.boomTime();break;case"item6":this.pickRandomSpecialItem();break}}backToHome(){this.cameras.main.fadeOut(300,0,0,0).once(n.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(t,e)=>{this.scene.stop("GamePlay"),this.scene.start("GameStart")})}turnToShop(){this.cameras.main.fadeOut(300,0,0,0).once(n.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(t,e)=>{this.scene.stop("GamePlay"),this.scene.start("GameShop")})}restartTheTurn(){this.cameras.main.fadeOut(300,0,0,0).once(n.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(t,e)=>{this.scene.stop("GamePlay"),this.scene.start("GamePlay")})}createOverlayMask(){this.isAnyModalOpen||(this.enableMainElements(!1),this.overlay=this.add.graphics(),this.overlay.fillStyle(0,.3).fillRect(0,0,game.config.width,game.config.height).setDepth(3))}enableMainElements(t){this.pauseButton.input.enabled=t,this.settingButton.input.enabled=t,this.currentSpecialItemGroup.getChildren().forEach(e=>{e.input.enabled=t})}showSettingModal(){if(!this.isAnyModalOpen){this.isAnyModalOpen=!0,this.input.off("pointermove");let t=this.isBgmPlay?"sound":"nosound",e=this.isSePlay?"sound":"nosound";this.settingModalContainer=this.add.container(0,0).setSize(400,160).setDepth(4),this.settingModalContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,160,4929584).setStrokeStyle(16,4929584);let a=this.add.text(game.config.width/2+100,game.config.height/2-100,"BGM",h[this.langIndex].ForTopPanelText);this.bgmButton=this.add.image(game.config.width/2+100,game.config.height/2-100,t).setScale(.6).setInteractive({useHandCursor:!0});let s=this.add.text(game.config.width/2+100,game.config.height/2-100,"SE",h[this.langIndex].ForTopPanelText);this.seButton=this.add.image(game.config.width/2+100,game.config.height/2-100,e).setScale(.6).setInteractive({useHandCursor:!0});let i=this.add.image(game.config.width/2+100,game.config.height/2-100,"close").setScale(.4).setInteractive({useHandCursor:!0});n.Display.Align.In.QuickSet(a,this.settingModalContent,4,-20,0),n.Display.Align.In.QuickSet(this.bgmButton,this.settingModalContent,4,-100,0),n.Display.Align.In.QuickSet(s,this.settingModalContent,8,-100,0),n.Display.Align.In.QuickSet(this.seButton,this.settingModalContent,8,-10,0),n.Display.Align.In.QuickSet(i,this.settingModalContent,2,20,20),this.settingModalContainer.add([this.settingModalContent,a,this.bgmButton,s,this.seButton,i]),i.on("pointerdown",()=>{this.destroySettingModal()}),this.bgmButton.on("pointerdown",()=>{this.setIsAudioPlayable("BGM",!this.isBgmPlay)}),this.seButton.on("pointerdown",()=>{this.setIsAudioPlayable("SE",!this.isSePlay)})}}destroySettingModal(){this.settingModalContainer&&(this.enableMainElements(!0),this.input.on("pointermove",this.adjustShooting,this),this.settingModalContainer.destroy(),this.overlay.destroy(),this.isAnyModalOpen=!1)}showPauseModal(){if(!this.isAnyModalOpen){this.isAnyModalOpen=!0,this.input.off("pointermove"),this.pauseModalContainer=this.add.container(0,0).setSize(400,200).setDepth(4),this.pauseModalContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,160,4929584).setStrokeStyle(16,4929584);let t=this.add.image(game.config.width/2+100,game.config.height/2-100,"home").setScale(.8).setInteractive({useHandCursor:!0}),e=this.add.image(game.config.width/2+100,game.config.height/2-100,"play").setScale(.8).setInteractive({useHandCursor:!0}),a=this.add.image(game.config.width/2+100,game.config.height/2-100,"restart").setScale(.8).setInteractive({useHandCursor:!0});n.Display.Align.In.QuickSet(t,this.pauseModalContent,4,-24,0),n.Display.Align.In.QuickSet(e,this.pauseModalContent,6),n.Display.Align.In.QuickSet(a,this.pauseModalContent,8,-24,0),this.pauseModalContainer.add([this.pauseModalContent,t,e,a]),e.on("pointerdown",()=>{this.destroyPauseModal()}),t.on("pointerdown",()=>{this.backToHome()}),a.on("pointerdown",()=>{this.restartTheTurn()})}}destroyPauseModal(){this.pauseModalContainer&&(this.enableMainElements(!0),this.input.on("pointermove",this.adjustShooting,this),this.pauseModalContainer.destroy(),this.overlay.destroy(),this.isAnyModalOpen=!1)}showRestartModal(){this.isAnyModalOpen=!0,this.restartModalContainer=this.add.container(0,0).setSize(400,300).setDepth(4),this.restartModalContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,300,4929584).setStrokeStyle(16,4929584),this.score>=1e4?this.estimatedLevel=1e4:this.score>=5e3&&this.score<1e4?(this.estimatedLevel=5e3,localStorage.setItem("isDarkUnlocked",!0)):this.score>=3e3&&this.score<5e3?this.estimatedLevel=3e3:this.score>=1e3&&this.score<3e3?this.estimatedLevel=1e3:this.score>=500&&this.score<1e3?this.estimatedLevel=500:this.score>=300&&this.score<500?this.estimatedLevel=300:this.score>=100&&this.score<300?this.estimatedLevel=100:this.estimatedLevel=0;let t=this.estimationWord[this.estimatedLevel],e=t[t.length*Math.random()|0],a=this.add.text(game.config.width/2+100,game.config.height/2-100,e,h[this.langIndex].ForEstimationText),s=this.add.text(game.config.width/2-120,game.config.height/2-75,j[this.langIndex],h[this.langIndex].ForEstiamtionTitle),i=this.add.text(game.config.width/2+60,game.config.height/2-75,this.score,h[this.langIndex].ForPanelNumber),o=this.add.text(game.config.width/2-120,game.config.height/2-125,U[this.langIndex],h[this.langIndex].ForEstiamtionTitle),r=this.add.text(game.config.width/2+60,game.config.height/2-125,this.highestHistoryScore,h[this.langIndex].ForPanelNumber),d=this.add.image(game.config.width/2+100,game.config.height/2-100,"home").setScale(.7).setInteractive({useHandCursor:!0}),m=this.add.image(game.config.width/2+100,game.config.height/2-100,"shop").setScale(.7).setInteractive({useHandCursor:!0}),S=this.add.image(game.config.width/2+100,game.config.height/2-100,"restart").setScale(.7).setInteractive({useHandCursor:!0});n.Display.Align.In.QuickSet(a,this.restartModalContent,6,0,10),n.Display.Align.In.QuickSet(d,this.restartModalContent,10,-30,-10),n.Display.Align.In.QuickSet(m,this.restartModalContent,11,0,-10),n.Display.Align.In.QuickSet(S,this.restartModalContent,12,-30,-10),this.restartModalContainer.add([this.restartModalContent,a,o,r,s,i,d,m,S]),d.on("pointerdown",()=>{this.backToHome()}),m.on("pointerdown",()=>{this.turnToShop()}),S.on("pointerdown",()=>{this.restartTheTurn()})}addSpecialItemTweens(t,e,a,s){try{let i=this.add.text(e,a,C[this.langIndex][t],h[this.langIndex].ForItemUsed).setStroke("#000000",16);this.tweens.add({targets:i,y:s,duration:1500,onComplete:()=>{i.destroy()}})}catch(i){console.log(i)}}setIsAudioPlayable(t,e){let a=e?"sound":"nosound";t=="BGM"&&(this.bgmButton.setTexture(a),this.isBgmPlay=e,localStorage.setItem("isBgmPlay",e),e?this.audioPlayer.play():this.audioPlayer.pause()),t=="SE"&&(this.seButton.setTexture(a),this.isSePlay=e,localStorage.setItem("isSePlay",e))}}function f(c){try{return c[c.length*Math.random()|0]}catch(t){return console.log(t),0}}class Q extends n.Scene{constructor(){super("GameShop")}preload(){this.load.image("panel","../assets/images/panel.png"),this.load.image("table","../assets/images/table.png"),this.load.image("darktable","../assets/images/darktable.png"),this.load.image("coin","../assets/images/coin.png"),this.load.image("bean0","../assets/images/beans/bean0.png"),this.load.image("bean1","../assets/images/beans/bean1.png"),this.load.image("bean2","../assets/images/beans/bean2.png"),this.load.image("block0","../assets/images/blocks/block0.png"),this.load.image("block1","../assets/images/blocks/block1.png"),this.load.image("block2","../assets/images/blocks/block2.png"),this.load.image("item0","../assets/images/special_items/item0.png"),this.load.image("item1","../assets/images/special_items/item1.png"),this.load.image("item2","../assets/images/special_items/item2.png"),this.load.image("item3","../assets/images/special_items/item3.png"),this.load.image("item4","../assets/images/special_items/item4.png"),this.load.image("item5","../assets/images/special_items/item5.png"),this.load.image("item6","../assets/images/special_items/item6.png"),this.load.image("tencyou01","../assets/images/tencyou/minigameShopMan01.png"),this.load.image("tencyou02","../assets/images/tencyou/minigameShopMan02.png"),this.load.image("tencyou03","../assets/images/tencyou/minigameShopMan03.png"),this.load.image("tencyou04","../assets/images/tencyou/minigameShopMan04.png"),this.load.image("tencyou05","../assets/images/tencyou/minigameShopMan05.png"),this.load.image("tencyou06","../assets/images/tencyou/minigameShopMan06.png"),this.load.image("tencyouWords","../assets/images/tencyou/shopDialog.png"),this.load.image("home","../assets/images/icons/home.png"),this.load.image("play","../assets/images/icons/play.png")}create(){this.beanIndex=localStorage.getItem("bean")!=null?localStorage.getItem("bean").replace("bean",""):0,this.blockIndex=localStorage.getItem("block")!=null?localStorage.getItem("block").replace("block",""):0,this.audioIndex=localStorage.getItem("audio")!=null?localStorage.getItem("audio").replace("audio",""):0,this.langIndex=localStorage.getItem("lang")!=null?localStorage.getItem("lang"):0,this.isBgmPlay=localStorage.getItem("isBgmPlay")!=null?localStorage.getItem("isBgmPlay"):!0,this.isSePlay=localStorage.getItem("isSePlay")!=null?localStorage.getItem("isSePlay"):!0,this.isDarkUnlocked=localStorage.getItem("isDarkUnlocked")?JSON.parse(localStorage.getItem("isDarkUnlocked")):!1,this.specialItemKeys=Object.keys(B),this.lightMerchantClickTimes=0,this.darkMerchantClickTimes=0,this.isTweenLocked=!0,this.lightShopTitle=_[this.langIndex],this.darkShopTitle=O[this.langIndex],this.itemNames=R[this.langIndex],this.blockSize=game.config.width/g.SHAPES_PER_LINE,this.gameFieldHeight=this.blockSize*g.SHAPES_ALL_LINES,this.emptySpace=game.config.height-this.gameFieldHeight,this.singleItemPrice=100,this.singlePowerPrice=1e3;let t=f(x[this.langIndex]),e=f(w[this.langIndex]);this.coins=localStorage.getItem("coin")!=null?localStorage.getItem("coin"):1e3,this.currentSpecialItems=[],this.currentSpecialItemGroup=this.add.group(),localStorage.getItem("myItems")!=null&&localStorage.getItem("myItems").split(",").forEach((i,o)=>{this.currentSpecialItemGroup.create((o+1)*150,1100,i).setScale(.4).setDepth(1)}),this.lightTopShopPanel=this.add.image(game.config.width/2,0,"panel"),this.lightTopShopPanel.displayWidth=game.config.width,this.lightTopShopPanel.displayHeight=this.emptySpace/2,this.lightTopShopPanel.setOrigin(.5,0),this.darkTopShopPanel=this.add.image(game.config.width/2-game.config.width,0,"panel"),this.darkTopShopPanel.displayWidth=game.config.width,this.darkTopShopPanel.displayHeight=this.emptySpace/2,this.darkTopShopPanel.setOrigin(.5,0),this.darkTopShopPanel.setTint(0),this.lightBottomShopPanel=this.add.image(game.config.width/2,game.config.height,"table"),this.lightBottomShopPanel.displayWidth=game.config.width,this.lightBottomShopPanel.displayHeight=this.emptySpace/2,this.lightBottomShopPanel.setOrigin(.5,1),this.darkBottomShopPanel=this.add.image(game.config.width/2-game.config.width,game.config.height,"darktable"),this.darkBottomShopPanel.displayWidth=game.config.width,this.darkBottomShopPanel.displayHeight=this.emptySpace/2,this.darkBottomShopPanel.setOrigin(.5,1),this.backToStartButton=this.add.image(80,100,"home").setScale(.6).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.backToHome()}),this.toNewTurnButton=this.add.image(game.config.width-80,100,"play").setScale(.6).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.playNewTurn()}),this.toShopCoinsExample=this.add.image(210,0,"coin").setScale(.2),this.addSingleTweens(this.toShopCoinsExample,"+=0",100,1500,0,"back.out"),this.toShopCoinsText=this.add.text(250,0,k[this.langIndex],h[this.langIndex].ForTopPanelText),this.toShopCoinsData=this.add.text(360,0,this.coins,h[this.langIndex].ForPanelNumber),this.tweens.add({targets:[this.toShopCoinsText,this.toShopCoinsData],y:80,duration:1500,repeat:0,ease:"back.out"}),this.shopTitleText=this.add.text(40,160,this.lightShopTitle,h[this.langIndex].ForShopTitleAfter).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.shopTitleText.setStyle(h[this.langIndex].ForShopTitleAfter),this.darkShopTitleText.setStyle(h[this.langIndex].ForShopTitleBefore),this.turnToTheOtherMarket(!1)}),this.isDarkUnlocked==!1?this.darkShopTitleText=this.add.text(game.config.width-280,160,"?******?",h[this.langIndex].ForShopTitleBefore):this.darkShopTitleText=this.add.text(game.config.width-280,160,this.darkShopTitle,h[this.langIndex].ForShopTitleBefore).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.darkShopTitleText.setStyle(h[this.langIndex].ForShopTitleAfter),this.shopTitleText.setStyle(h[this.langIndex].ForShopTitleBefore),this.turnToTheOtherMarket(!0)}),this.hangText=this.add.text(40,240,G[this.langIndex],h[this.langIndex].ForHangWords),this.darkhangText=this.add.text(40-game.config.width,240,F[this.langIndex],h[this.langIndex].ForHangWords),this.goodItems=[],this.goodPrices=[],this.displayItems=[],this.powerPrices=[],this.bgCircles=[];for(let s=0;s<this.specialItemKeys.length-1;s++){let i=s%3+1,o=(s-i+1)/3+1;this.goodItems[s]=this.add.text(i*160-90,o*200+210,this.itemNames[s],h[this.langIndex].ForShopText),this.goodPrices[s]=this.add.text(i*150-25,o*200+250,this.singleItemPrice,h[this.langIndex].ForShopNumber),this.displayItems[s]=this.add.image(i*150,o*200+150,"item"+s).setScale(.4).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.purchaseTheSpecialItemInLight(s)}),s<3&&(this.bgCircles[s]=this.add.circle(i*150,game.config.height-100,56,"0x3b2820"))}this.lightBeanMerchant=this.add.image(game.config.width-80,game.config.height-220,"tencyou01").setInteractive({useHandCursor:!0}).setOrigin(1).setDepth(-1).on("pointerdown",()=>{this.merchantSayWords()}),this.lightBeanMerchant.displayHeight=240,this.lightBeanMerchant.displayWidth=240,this.tweens.add({targets:this.lightBeanMerchant,scaleY:.49,duration:1e3,yoyo:!0,repeat:-1}),this.lightBeanMerchantDialog=this.add.image(150,game.config.height-360,"tencyouWords").setInteractive({useHandCursor:!0}),this.lightBeanMerchantDialog.displayHeight=240,this.lightBeanMerchantDialog.displayWidth=300,this.lightBeanMerchantWord=this.add.text(36,game.config.height-420,t,h[this.langIndex].ForMerchantWords).setPadding(12),this.itemPurchaseText=this.add.text(40,game.config.height-220,L[this.langIndex],h[this.langIndex].ForBottomPanelText).setPadding(12),this.darkBeanMerchant=this.add.image(280-game.config.width,game.config.height-220,"tencyou05").setInteractive({useHandCursor:!0}).setOrigin(1).setDepth(-1).on("pointerdown",()=>{this.darkMerchantSayWords()}),this.darkBeanMerchant.displayHeight=240,this.darkBeanMerchant.displayWidth=240,this.tweens.add({targets:this.darkBeanMerchant,scaleY:.49,duration:1e3,yoyo:!0,repeat:-1}),this.darkBeanMerchantDialog=this.add.image(game.config.width-180-game.config.width,game.config.height-360,"tencyouWords").setFlipX(!0),this.darkBeanMerchantDialog.displayHeight=240,this.darkBeanMerchantDialog.displayWidth=300,this.darkBeanMerchantWord=this.add.text(game.config.width-260-game.config.width,game.config.height-420,e,h[this.langIndex].ForMerchantWords).setPadding(12),this.darkPowerPurchaseText1=this.add.text(20-game.config.width,game.config.height-220,b[this.langIndex][0],h[this.langIndex].ForBottomPanelText).setPadding(12),this.darkPowerPurchaseText2=this.add.text(200-game.config.width,game.config.height-220,b[this.langIndex][1],h[this.langIndex].ForBottomPanelText).setPadding(12),this.darkPowerPurchaseText3=this.add.text(380-game.config.width,game.config.height-220,b[this.langIndex][2],h[this.langIndex].ForBottomPanelText).setPadding(12),this.darkBgCircles=[],this.displayBeans=[],this.displayBlocks=[],this.displayAudios=[],this.displayTexts=[];for(let s=0;s<9;s++){let i=s%3+1,o=(s-i+1)/3+1;s<3&&(this.darkBgCircles[s]=this.add.circle((s+1)*150-game.config.width,game.config.height-100,56,"0x3b2820"),this.displayBeans[s]=this.add.image((s+1)*150-game.config.width,340,"bean"+s).setScale(.3).setDepth(1).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.purchaseTheSpecialItemInDark("bean"+s)}),this.displayBlocks[s]=this.add.image((s+1)*150-game.config.width,490,"block"+s).setScale(.3).setDepth(1).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.purchaseTheSpecialItemInDark("block"+s)}),this.langIndex==0&&(this.displayAudios[s]=this.add.text((s+1)*150-40-game.config.width,620,y[s],h[this.langIndex].ForAudioDisplay).setDepth(1).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.purchaseTheSpecialItemInDark("audio"+s)}))),this.langIndex==0?this.displayTexts[s]=this.add.text(i*150-40-game.config.width,o*150+230,this.singlePowerPrice,h[this.langIndex].ForShopNumber):s<6&&(this.displayTexts[s]=this.add.text(i*150-40-game.config.width,o*150+230,this.singlePowerPrice,h[this.langIndex].ForShopNumber))}if(this.boughtTags=[],!localStorage.getItem("boughtPowers")){let s=["bean0","block0","audio0"];localStorage.setItem("boughtPowers",JSON.stringify(s))}let a=localStorage.getItem("boughtPowers")?JSON.parse(localStorage.getItem("boughtPowers")):[];if(a.length!=0)for(let s=0;s<a.length;s++){let i=a[s],o,r,d;i.includes("bean")&&(o=JSON.parse(i.replace("bean","")),r=(o+1)*150+20-game.config.width,d=380,this.boughtTags[s]=this.add.text(r,d,"GOT!",{fontFamily:"Arial",fontSize:28}).setDepth(2).setStroke("#FFBC02",6)),i.includes("block")&&(o=JSON.parse(i.replace("block","")),r=(o+1)*150+20-game.config.width,d=530,this.boughtTags[s]=this.add.text(r,d,"GOT!",{fontFamily:"Arial",fontSize:28}).setDepth(2).setStroke("#FFBC02",6)),i.includes("audio")&&this.langIndex==0&&(o=JSON.parse(i.replace("audio","")),r=(o+1)*150+20-game.config.width,d=680,this.boughtTags[s]=this.add.text(r,d,"GOT!",{fontFamily:"Arial",fontSize:28}).setDepth(2).setStroke("#FFBC02",6))}this.beanPower=this.add.image(150-game.config.width,game.config.height-100,"bean"+this.blockIndex).setScale(.3).setDepth(1),this.blockPower=this.add.image(150*2-game.config.width,game.config.height-100,"block"+this.blockIndex).setScale(.3).setDepth(1),this.langIndex==0?this.audioPower=this.add.text(150*3-40-game.config.width,game.config.height-140,y[this.audioIndex],h[this.langIndex].ForAudioDisplay):this.audioPower=this.add.text(150*3-30-game.config.width,game.config.height-120,"???",h[this.langIndex].ForBottomPanelText)}update(){}backToHome(){this.cameras.main.fadeOut(300,0,0,0).once(n.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(t,e)=>{this.scene.stop("GameShop"),this.scene.start("GameStart")})}playNewTurn(){this.cameras.main.fadeOut(300,0,0,0).once(n.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(t,e)=>{this.scene.stop("GameShop"),this.scene.start("GamePlay")})}purchaseTheSpecialItemInLight(t){if(this.coins<100)this.lightBeanMerchantWord.setText(N[this.langIndex]);else{this.coins-=100,this.toShopCoinsData.setText(this.coins);let e="item"+t,a=this.currentSpecialItemGroup.getChildren().length;if(a<3&&this.currentSpecialItemGroup.create((a+1)*150,1100,e).setScale(.4).setDepth(1),a==3){let o=this.currentSpecialItemGroup.create(a*150,game.config.height,e).setScale(.4).setDepth(1),r=this.currentSpecialItemGroup.getChildren(),d=r[0],m=r.slice(1,r.length-1);this.tweens.add({targets:d,y:"+=100",duration:300,onComplete:()=>{this.currentSpecialItemGroup.remove(d),d.destroy()}}),this.tweens.add({targets:m,x:"-=150",duration:300}),this.tweens.add({targets:o,y:"-=100",duration:300})}let s=this.currentSpecialItemGroup.getChildren(),i=[];s.forEach(o=>{i.push(o.texture.key)}),i.length<4?localStorage.setItem("myItems",i):localStorage.setItem("myItems",i.slice(1,i.length))}}purchaseTheSpecialItemInDark(t){if(this.coins<1e3)this.darkBeanMerchantWord.setText(D[this.langIndex]);else{let e=localStorage.getItem("boughtPowers")?JSON.parse(localStorage.getItem("boughtPowers")):[];if(e.indexOf(t)==-1&&(this.coins-=1e3,this.toShopCoinsData.setText(this.coins),e.push(t),localStorage.setItem("boughtPowers",JSON.stringify(e))),t.includes("bean")&&(localStorage.setItem("bean",t),this.beanPower.setTexture(t)),t.includes("block")&&(localStorage.setItem("block",t),this.blockPower.setTexture(t)),t.includes("audio")){localStorage.setItem("audio",t);let a=t.replace("audio","");this.audioPower.setText(y[a])}}}merchantSayWords(){if(this.lightMerchantClickTimes>20)this.lightBeanMerchant.setTexture("tencyou04"),this.lightBeanMerchantWord.setText(v[this.langIndex]);else{let t=f(x[this.langIndex]);this.lightBeanMerchantWord.setText(t),this.lightMerchantClickTimes++;let a="tencyou0"+(Math.floor(Math.random()*3)+1);this.lightBeanMerchant.setTexture(a)}}darkMerchantSayWords(){if(this.darkMerchantClickTimes>20)this.darkBeanMerchant.setTexture("tencyou06"),this.darkBeanMerchantWord.setText(H[this.langIndex]);else{let t=f(w[this.langIndex]);this.darkBeanMerchantWord.setText(t),this.darkMerchantClickTimes++}}turnToTheOtherMarket(t){let e=[this.darkBeanMerchant,this.darkBeanMerchantDialog,this.darkBeanMerchantWord,this.darkPowerPurchaseText1,this.darkPowerPurchaseText2,this.darkPowerPurchaseText3,this.darkTopShopPanel,this.darkBottomShopPanel,this.darkhangText,this.beanPower,this.blockPower,this.audioPower,this.powerPrices,this.lightBeanMerchant,this.lightBeanMerchantDialog,this.lightBeanMerchantWord,this.lightTopShopPanel,this.lightBottomShopPanel,this.itemPurchaseText,this.hangText,this.currentSpecialItemGroup.getChildren(),this.bgCircles,this.darkBgCircles,this.displayBeans,this.displayBlocks,this.displayAudios,this.displayTexts,this.displayItems,this.goodItems,this.goodPrices,this.boughtTags],a=[].concat(...e);t&&this.isTweenLocked&&this.tweens.add({targets:a,x:"+=600",duration:1500,ease:"Power4",onComplete:()=>{this.isTweenLocked=!1}}),!t&&!this.isTweenLocked&&this.tweens.add({targets:a,x:"-=600",duration:1500,ease:"Power4",onComplete:()=>{this.isTweenLocked=!0}})}addSingleTweens(t,e,a,s,i,o){this.tweens.add({targets:t,x:e,y:a,duration:s,repeat:i,ease:o})}}class T extends n.GameObjects.Image{constructor(t,e,a,s,i){super(t,e,a,s),this.setInteractive({useHandCursor:!0}),t.add.existing(this)}}class J extends n.Scene{constructor(){super("GameStart")}preload(){this.load.image("gametitle0","../assets/images/minigametitle0.png"),this.load.image("gametitle1","../assets/images/minigametitle1.png"),this.load.image("gametitle2","../assets/images/minigametitle2.png"),this.load.image("panel","../assets/images/panel.png"),this.load.image("play","../assets/images/icons/play.png"),this.load.image("shop","../assets/images/icons/shop.png"),this.load.image("setting","../assets/images/icons/setting.png"),this.load.image("close","../assets/images/icons/close.png"),this.load.image("sound","../assets/images/icons/sound.png"),this.load.image("nosound","../assets/images/icons/nosound.png"),this.load.audio("bgm","../assets/audios/bgm.mp3")}create(){this.langIndex=localStorage.getItem("lang")!=null?localStorage.getItem("lang"):0,this.isBgmPlay=localStorage.getItem("isBgmPlay")!=null?JSON.parse(localStorage.getItem("isBgmPlay")):!1,this.isSePlay=localStorage.getItem("isSePlay")!=null?JSON.parse(localStorage.getItem("isSePlay")):!0,this.audioPlayer=document.querySelector(".bgm-audio"),this.isBgmPlay&&this.audioPlayer.play(),this.isAnyModalOpen=!1,this.blockSize=game.config.width/g.SHAPES_PER_LINE,this.gameFieldHeight=this.blockSize*g.SHAPES_ALL_LINES,this.emptySpace=game.config.height-this.gameFieldHeight,this.topPanel=this.add.image(game.config.width/2,0,"panel"),this.topPanel.displayWidth=game.config.width,this.topPanel.displayHeight=this.emptySpace/2,this.topPanel.setOrigin(.5,0),this.bottomPanel=this.add.image(game.config.width/2,game.config.height,"panel"),this.bottomPanel.displayWidth=game.config.width,this.bottomPanel.displayHeight=this.emptySpace/2,this.bottomPanel.setOrigin(.5,1),this.gameTitle=this.add.image(game.config.width/2,0,"gametitle"+this.langIndex).setDepth(1),this.tweens.add({targets:this.gameTitle,y:450,duration:1e3,repeat:0,ease:"back.out"}),this.playButton=new T(this,140,0,"play",null),this.shopButton=new T(this,300,0,"shop",null),this.settingButton=new T(this,460,0,"setting",null),this.tweens.add({targets:[this.playButton,this.shopButton,this.settingButton],y:700,duration:1e3,repeat:0,ease:"back.out"}),this.langSetButton=this.add.text(40,40,A[this.langIndex],h[this.langIndex].ForTopPanelText).setPadding(24).setInteractive({useHandCursor:!0}),this.aboutusButton=this.add.text(game.config.width-40-200,40,M[this.langIndex],h[this.langIndex].ForTopPanelText).setPadding(24).setInteractive({useHandCursor:!0}),this.playButton.on("pointerdown",()=>{this.tweens.add({targets:this.playButton,y:"+=20",duration:100,yoyo:!0,repeat:0,onComplete:()=>{this.startNewTurn()}})}),this.shopButton.on("pointerdown",()=>{this.tweens.add({targets:this.shopButton,y:"+=20",duration:100,yoyo:!0,repeat:0,onComplete:()=>{this.goItemShopping()}})}),this.settingButton.on("pointerdown",()=>{this.tweens.add({targets:this.settingButton,y:"+=20",duration:100,yoyo:!0,repeat:0,onComplete:()=>{this.createOverlayMask(),this.showSettingsModal()}})}),this.langSetButton.on("pointerdown",()=>{this.createOverlayMask(),this.showLangOptionModal()}),this.langSetButton.on("pointerover",()=>{this.langSetButton.setBackgroundColor("#3b2820")}).on("pointerout",()=>{this.langSetButton.setBackgroundColor("#4b3830")}),this.aboutusButton.on("pointerdown",()=>{this.createOverlayMask(),this.showAboutusModal()}),this.aboutusButton.on("pointerover",()=>{this.aboutusButton.setBackgroundColor("#3b2820")}).on("pointerout",()=>{this.aboutusButton.setBackgroundColor("#4b3830")})}update(){}startNewTurn(){this.cameras.main.fadeOut(300,0,0,0).once(n.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(t,e)=>{this.scene.stop("GameStart"),this.scene.start("GamePlay")})}goItemShopping(){this.cameras.main.fadeOut(300,0,0,0).once(n.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,(t,e)=>{this.scene.stop("GameStart"),this.scene.start("GameShop")})}enableMainButtons(t){this.aboutusButton.input.enabled=t,this.langSetButton.input.enabled=t,this.playButton.input.enabled=t,this.shopButton.input.enabled=t,this.settingButton.input.enabled=t}createOverlayMask(){this.isAnyModalOpen||(this.enableMainButtons(!1),this.overlay=this.add.graphics(),this.overlay.fillStyle(0,.3).fillRect(0,0,game.config.width,game.config.height).setDepth(1))}showAboutusModal(){if(!this.isAnyModalOpen){this.isAnyModalOpen=!0,this.aboutUsContainer=this.add.container(0,0).setSize(400,120),this.aboutUsContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,120,4929584).setStrokeStyle(16,4929584);let t=this.add.text(game.config.width/2-200,game.config.height/2,E[this.langIndex],h[this.langIndex].ForAboutusText),e=this.add.image(game.config.width/2+100,game.config.height/2-100,"close").setScale(.4).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.destroyAboutUsModal()});n.Display.Align.In.QuickSet(e,this.aboutUsContent,2,24,24),n.Display.Align.In.QuickSet(t,this.aboutUsContent,6,0,0),this.aboutUsContainer.add([this.aboutUsContent,t,e]).setDepth(1)}}showLangOptionModal(){if(!this.isAnyModalOpen){this.isAnyModalOpen=!0,this.langContainer=this.add.container(0,0).setSize(400,160),this.langContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,160,4929584).setStrokeStyle(16,4929584);let t=this.add.text(game.config.width/2-100,game.config.height/2,I[this.langIndex][0],h[this.langIndex].ForTopPanelText).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{localStorage.setItem("lang",0),this.scene.start("GameStart")}),e=this.add.text(game.config.width/2,game.config.height/2,I[this.langIndex][1],h[this.langIndex].ForTopPanelText).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{localStorage.setItem("lang",1),this.scene.start("GameStart")}),a=this.add.text(game.config.width/2+100,game.config.height/2,I[this.langIndex][2],h[this.langIndex].ForTopPanelText).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{localStorage.setItem("lang",2),this.scene.start("GameStart")}),s=this.add.image(game.config.width/2+100,game.config.height/2-100,"close").setScale(.4).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.destroyLangOptionModal()});n.Display.Align.In.QuickSet(s,this.langContent,2,24,24),n.Display.Align.In.QuickSet(t,this.langContent,4,-20,0),n.Display.Align.In.QuickSet(e,this.langContent,6,0,0),n.Display.Align.In.QuickSet(a,this.langContent,8,-20,0),this.langContainer.add([this.langContent,t,e,a,s]).setDepth(1)}}showSettingsModal(){if(!this.isAnyModalOpen){this.isAnyModalOpen=!0,this.settingContainer=this.add.container(0,0).setSize(400,160),this.settingContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,160,4929584).setStrokeStyle(16,4929584);let t=this.isBgmPlay?"sound":"nosound",e=this.isSePlay?"sound":"nosound",a=this.add.text(game.config.width/2+100,game.config.height/2-100,"BGM",h[this.langIndex].ForTopPanelText);this.bgmButton=this.add.image(game.config.width/2+100,game.config.height/2-100,t).setScale(.6).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.setIsAudioPlayable("BGM",!this.isBgmPlay)});let s=this.add.text(game.config.width/2+100,game.config.height/2-100,"SE",h[this.langIndex].ForTopPanelText);this.seButton=this.add.image(game.config.width/2+100,game.config.height/2-100,e).setScale(.6).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.setIsAudioPlayable("SE",!this.isSePlay)});let i=this.add.image(game.config.width/2+100,game.config.height/2-100,"close").setScale(.4).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.destroySettingModal()});n.Display.Align.In.QuickSet(a,this.settingContent,4,-20,0),n.Display.Align.In.QuickSet(this.bgmButton,this.settingContent,4,-100,0),n.Display.Align.In.QuickSet(s,this.settingContent,8,-100,0),n.Display.Align.In.QuickSet(this.seButton,this.settingContent,8,-10,0),n.Display.Align.In.QuickSet(i,this.settingContent,2,20,20),this.settingContainer.add([this.settingContent,a,this.bgmButton,s,this.seButton,i]).setDepth(1)}}destroyLangOptionModal(){this.langContainer&&(this.enableMainButtons(!0),this.langContainer.destroy(),this.overlay.destroy(),this.isAnyModalOpen=!1)}destroyAboutUsModal(){this.aboutUsContainer&&(this.enableMainButtons(!0),this.aboutUsContainer.destroy(),this.overlay.destroy(),this.isAnyModalOpen=!1)}destroySettingModal(){this.settingContainer&&(this.enableMainButtons(!0),this.settingContainer.destroy(),this.overlay.destroy(),this.isAnyModalOpen=!1)}setIsAudioPlayable(t,e){let a=e?"sound":"nosound";t=="BGM"&&(this.bgmButton.setTexture(a),this.isBgmPlay=e,localStorage.setItem("isBgmPlay",e),e?this.audioPlayer.play():this.audioPlayer.pause()),t=="SE"&&(this.seButton.setTexture(a),this.isSePlay=e,localStorage.setItem("isSePlay",e))}}const Z={type:n.AUTO,backgroundColor:"#3b2826",scale:{mode:n.Scale.FIT,autoCenter:n.Scale.CENTER_BOTH,width:600,height:1200,fullscreenTarget:"bean-game"},physics:{default:"arcade",arcade:{debug:!1}},parent:"bean-game",scene:[J,Q,K],title:"Yellow Bean Bean",version:"1.0.0",url:"",banner:{text:"#ffffff",background:["#000000","#ffcb30"],hidePhaser:!1}};window.addEventListener("load",()=>{const c=new n.Game(Z);window.game=c})});
