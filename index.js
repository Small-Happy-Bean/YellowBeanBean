(()=>{"use strict";const t=Phaser,e={HAPPY_BE_LAZY:0,JUST_WANT_IT:1,DOUBLE_BEANS_RUN:2,ALL_YOU_FROZEN:3,CYBER_IKUZO:4,RED_TEMPER_BOMB:5,AKAMI_MAGIC:6},i=[{HAPPY_BE_LAZY:"偷懒了~嘻嘻~",JUST_WANT_IT:"有钱真好啊~",DOUBLE_BEANS_RUN:"双人成行的美好时光~",ALL_YOU_FROZEN:"冻结时间！",CYBER_IKUZO:"勇者，出击！",RED_TEMPER_BOMB:"红温了！",AKAMI_MAGIC:"阿卡莱斯魔术，启动！"},{HAPPY_BE_LAZY:"Enjoy lazy time~",JUST_WANT_IT:"I am money love~",DOUBLE_BEANS_RUN:"Be Friend Forever!",ALL_YOU_FROZEN:"Freezing Time!",CYBER_IKUZO:"Cyber BEAMMMM!",RED_TEMPER_BOMB:"BOOM!",AKAMI_MAGIC:"AKAMI MAGIC! START!"},{HAPPY_BE_LAZY:"眠たいなぁ～",JUST_WANT_IT:"お金、欲しい！",DOUBLE_BEANS_RUN:"いつでも仲良し！",ALL_YOU_FROZEN:"これは、風吹雪",CYBER_IKUZO:"勇者、行くぞ！",RED_TEMPER_BOMB:"怒るだよ！",AKAMI_MAGIC:"アカミマジック！スタート！"}],s=[{ForPanelNumber:{fontSize:36,fontFamily:"Impact"},ForTopPanelText:{fontSize:36,fontFamily:"AlibabaFangYuan"},ForBottomPanelText:{fontSize:36,fontFamily:"AlibabaFangYuan"},ForShopNumber:{fontSize:30,fontFamily:"Impact"},ForShopText:{fontSize:24,fontFamily:"AlibabaFangYuan"},ForShopTitleBefore:{fontSize:36,fontFamily:"AlibabaFangYuan",backgroundColor:"transparent",color:"white"},ForShopTitleAfter:{fontSize:36,fontFamily:"AlibabaFangYuan",backgroundColor:"white",color:"#3b2820"},ForMerchantWords:{fontSize:24,fontFamily:"AlibabaFangYuan",color:"#000000"},ForHangWords:{fontSize:28,fontFamily:"AlibabaFangYuan",backgroundColor:"white",color:"#3b2820"},ForAboutusText:{fontSize:24,fontFamily:"AlibabaFangYuan"},ForEstiamtionTitle:{fontSize:36,fontFamily:"AlibabaFangYuan"},ForEstimationText:{fontSize:30,fontFamily:"AlibabaFangYuan",color:"#ffe945"},ForItemUsed:{fontSize:36,fontFamily:"AlibabaFangYuan"},ForAudioDisplay:{fontSize:24,fontFamily:"AlibabaFangYuan"}},{ForPanelNumber:{fontSize:36,fontFamily:"Impact"},ForTopPanelText:{fontSize:32,fontFamily:"Comic Sans MS"},ForBottomPanelText:{fontSize:24,fontFamily:"Comic Sans MS",padding:4},ForShopNumber:{fontSize:30,fontFamily:"Impact"},ForShopText:{fontSize:16,fontFamily:"Comic Sans MS"},ForShopTitleBefore:{fontSize:20,fontFamily:"Comic Sans MS",backgroundColor:"transparent",color:"white"},ForShopTitleAfter:{fontSize:20,fontFamily:"Comic Sans MS",backgroundColor:"white",color:"#3b2820"},ForMerchantWords:{fontSize:24,fontFamily:"Comic Sans MS",color:"#000000"},ForHangWords:{fontSize:28,fontFamily:"Comic Sans MS",backgroundColor:"white",color:"#3b2820"},ForAboutusText:{fontSize:24,fontFamily:"Comic Sans MS"},ForEstiamtionTitle:{fontSize:22,padding:6,fontFamily:"Comic Sans MS"},ForEstimationText:{fontSize:28,fontFamily:"Comic Sans MS",color:"#ffe945"},ForItemUsed:{fontSize:36,fontFamily:"Comic Sans MS",padding:8}},{ForPanelNumber:{fontSize:36,fontFamily:"Impact"},ForTopPanelText:{fontSize:32,fontFamily:"HGGothicE"},ForBottomPanelText:{fontSize:30,fontFamily:"HGGothicE",padding:4},ForShopNumber:{fontSize:30,fontFamily:"Impact"},ForShopText:{fontSize:22,fontFamily:"HGGothicE"},ForShopTitleBefore:{fontSize:36,fontFamily:"HGGothicE",backgroundColor:"transparent",color:"white"},ForShopTitleAfter:{fontSize:36,fontFamily:"HGGothicE",backgroundColor:"white",color:"#3b2820"},ForMerchantWords:{fontSize:24,fontFamily:"HGGothicE",color:"black"},ForHangWords:{fontSize:28,fontFamily:"HGGothicE",backgroundColor:"white",color:"#3b2820"},ForAboutusText:{fontSize:24,fontFamily:"HGGothicE"},ForEstiamtionTitle:{fontSize:32,fontFamily:"HGGothicE",padding:4},ForEstimationText:{fontSize:30,fontFamily:"HGGothicE",color:"#ffe945"},ForItemUsed:{fontSize:32,fontFamily:"HGGothicE"}}],a=["语言","LANG","言語設定"],o=[["中文","英语","日语"],["CN","EN","JP"],["中国語","英語","日本語"]],n=["关于","ABOUT","関して"],h=["谨以纪念黄豆小组的愉快时光。","To Remember Happy Days \nin Yellow Bean Team.","「豆」チームに楽しい日々を\n記念する為に…"],l=["黄豆海鲜市场","YellowBean SeaFood Shop","表・豆豆屋"],d=["黑豆咩咩市场","BlackBean Maa-Maa Shop","裏・豆豆屋"],r=["点击道具即可购买！记得有钱！","Click the item to purchase in~","クリックして買える、お金あったら！"],g=["点击商品即可入手捏~有钱的话~","Click the power to purchase in~","クリックしてゲットだ～お金足りだか？"],c=["持有道具","Current Items","持ちアイテム"],m=[["持有黄豆","持有方块","持有音效"],["Current Bean","Current Block","Current Sound"],["持ち豆","持ちブロック","持ち音"]],p=[["人生像浓豆浆\n一样一团浆糊......","好玩吗？这不好\n玩，单纯是你太\n无聊了而已。","我们不过是\n舞台上的摆设\n，想扔就扔......","我想抽却不\n能抽你~没有\n你世界只剩死寂~","买道具要适度\n！打完一把就走！","我顶飞你啊！\n"],["Life is just a\n mess like\n bean salad","Do you think\n this game\n interesting?\n Perhaps not!","We are NPCs,\n remembered \n or forgotten...","Do you feel\n better today?","Special items\n can be good,\n but cost money!","***Filterd***"],["悲劇を避ける\n為に、今から\n悪いことしないで\nほうがいいよ．．．","いい世、来い？\nかもしれませんね。","苦しいけど、\n出来るなら\n出来るまで\n生きている．．．","一生で忘れない、\nそんな話、\nちょっと悲しみを\n感じるちゃん．．．","8時間眠できる\nはいい文明だぞ！","好き人いなら\n告白しよう？"]],u=[["哼！居然被你\n发现了咩咩市场！\n买了皮肤也不能\n让你强大哦！","给了足够的钱\n才能开放好玩的\n东西哦！\n再玩几下吧~","苦痛的生活也要\n坚强起来啊......\n活下去吧亲。"],["I don't think\n how you deed\n any relation\n with the cover...","No enough coin~ \nHow dare you\n to open one?","Already go so\n far... Be brave,\n and may\n you good life~"],["ある時、実力は\n使い物の形とは\n関係ない、かも\nしれませんね。","お金が足りて、\n面白いことを\n開放されでき\nだなぁ！","悲しいですか？\n諦めないで、\n人生はまだ\n終わらない！"]],S=["豆币不够诶！","Coin no enough!","コイン、足りないだぞ？"],b=["豆币不够\n可以去挣哦？","Maybe you need more coins~","コイン足りない\nよ？頑張ってね！"],y=["该去咩咩市场找\n安慰哦？你这\n没礼貌的家伙......","So rude! Go\n Maa-Maa Shop\n for comforts,\n please?","失礼よお前．．．\n裏・豆豆屋に\nほうがいいぞ．．．"],f=["愿你的内心\n如梦境般安宁......\n我亲爱的勇者\n大人......","May you heart\n peace like dream.\n My Dear Mr.\n Adventurer...","心の中、夢のよう\nな、穏やかなに、\nいいですよね．．．\n我らの勇者様．．．"],I=["默认","吉吉国\n的谜之声","草场最\n可爱的一集"],B=[["偷懒是好文明","好想要有钱啊","俩黄豆跑得快","塞可罗吉之雪","勇者光炮出击","红温的爆爆爆","阿卡莱斯魔术"],["HAPPY_BE_LAZY","JUST_WANT_IT","DOUBLE_BEANS_RUN","ALL_YOU_FROZEN","CYBER_IKUZO","RED_TEMPER_BOMB","AKAMI_MAGIC"],["眠たいね～","千兆円欲しい！","お二つは走るよ","凍るだよ？","勇者、行くぞ！","怒るなぁ俺！","アカミマジック"]],x=["豆币","Coin","コイン"],w=["得分","Score","スコア"],T=["黄豆","Bean","豆"],k=["道具","Item","アイテム"],P=["历史最高","History Highest","歴史最高"],C=["本次得分","Current Score","今回点数"],M={BALL_SIZE:.09,BALL_SPEED:2e3,SHAPES_PER_LINE:8,SHAPES_ALL_LINES:10,MAX_SHAPES_NUM_PER_LINE:4,EXTRA_BEAN_PROBABILITY:80,PREDICTIVE_SHOOTING_TRAIL_LENGTH:2e3,SPECIAL_ITEM_SIZE:.1,SPECIAL_ITEM_PROBABILTIY:20},A=["0x8a2c24","0xffdd6e","0x66c204","0x03aba8","0x0099bf","0x8a3b94","0x82003d"],E=[{0:["杂鱼杂鱼~才打这么点~","YOU DIED（菜就多练）","会认可这样草率的结局吗......"],100:["这样啊......","旅途才刚刚开始哦~","要加油哦，勇者大人！"],300:["要奖励你一块小蛋糕吗？","有时候不要太勉强自己哦？","变强可不是一天\n就能完成的事情呢。"],500:["点个火吧。\n让我们休息一会儿...","回过头来，\n没有后悔药了呢。","我们会打败那里的风车吗？"],1e3:["据说新王会在信念中诞生哦？","已经走了这么远了啊......","很厉害了啊，\n像那迫近的风暴....."],3e3:["心怀着希望前进吧。","真乃勇士也......","强大，无需多言。"],5e3:["好像解锁了神秘的地方？","传说，出现了啊。","辛苦了。\n为您献上一杯卡布奇诺~"],1e4:["在此见证新王的诞生......","已经到这里了，\n还要战斗下去吗？","或许不会是最后的结局......"]},{0:["Better to take it seriously?","YOU DIED (Joke)","Not mind ending so fast?..."],100:["So it goes...","Trip just begins here~","Fighting, Mr.Adventurer!"],300:["A piece of cake for you?","Sometimes do not do\n what out of your ability...","Rome is not built in a day..."],500:["Lit a fire.\n Let's take a break.","Look back,\n no chance for regret.","Do you think we could\n defeat the windmill there?"],1e3:["It's said, New Lord would\n be born in the belief, right?","Already gone so far...\n Brave man...","Like the storm approaching,\n in my eyes..."],3e3:["Go ahead! With hope in heart.","You brave adventurer...","So strong. No more words..."],5e3:["Somewhere unlocked?","Legend, appears now...","Would you like a cup of Latte?\n Just for you."],1e4:["Here. Witness\n the born of the New Lord!","Feel tired?\n If so, may you good rest...","Adventure would not end\n here? Maybe... "]},{0:["雑魚雑魚～弱いかもね？","YOU DIED（大噓）","こんな草な結局、\n受け取っていい？"],100:["そうですね．．．","旅は、ただ始まるぞ？","頑張てね！勇者様！"],300:["おケーキ、食べ欲しい？\nこれ、差しれ～","ある時、\n無理しないでください。","強いになることは、\n一日中できないですよ～"],500:["焚き火をつけて、\n少々休みましょう．．．","振り返って、\n後悔の機会がないぞ？","我らは、あそこの風車を\n倒すこと、できるか？"],1e3:["新しいの王様は、\n信念の中で現れるかもよ？","もう、ここにいるか．．．","すごいな．．．\n嵐のように．．．"],3e3:["希望を持って、\n前に歩き行こう．．．","さすが勇者様だ．．．","強さを、\nもう言えない．．．"],5e3:["ある場所は\n開放でしょうか．．．","伝説が、始まる．．．","お疲れ様です。モカ\nコーヒー、いかがですか？"],1e4:["ここに、\n新しいの王様がある。","ちょっと、疲れた．．．","ここは、\n最後の結局ですか？"]}];class F extends t.Scene{constructor(){super("GamePlay")}preload(){this.load.image("bean0","./assets/images/beans/bean0.png"),this.load.image("bean1","./assets/images/beans/bean1.png"),this.load.image("bean2","./assets/images/beans/bean2.png"),this.load.image("block0","./assets/images/blocks/block0.png"),this.load.image("block1","./assets/images/blocks/block1.png"),this.load.image("block2","./assets/images/blocks/block2.png"),this.load.image("point","./assets/images/point.png"),this.load.image("beampoint","./assets/images/beampoint.png"),this.load.image("item0","./assets/images/special_items/item0.png"),this.load.image("item1","./assets/images/special_items/item1.png"),this.load.image("item2","./assets/images/special_items/item2.png"),this.load.image("item3","./assets/images/special_items/item3.png"),this.load.image("item4","./assets/images/special_items/item4.png"),this.load.image("item5","./assets/images/special_items/item5.png"),this.load.image("item6","./assets/images/special_items/item6.png"),this.load.image("coin","./assets/images/coin.png"),this.load.image("lightcoin","./assets/images/lightCoin.png"),this.load.image("panel","./assets/images/panel.png"),this.load.image("home","./assets/images/icons/home.png"),this.load.image("play","./assets/images/icons/play.png"),this.load.image("shop","./assets/images/icons/shop.png"),this.load.image("pause","./assets/images/icons/pause.png"),this.load.image("setting","./assets/images/icons/setting.png"),this.load.image("restart","./assets/images/icons/restart.png"),this.load.image("close","./assets/images/icons/close.png"),this.load.image("sound","./assets/images/icons/sound.png"),this.load.image("nosound","./assets/images/icons/nosound.png"),this.load.audio("bgm","./assets/audios/bgm.mp3"),this.load.audio("ding","./assets/audios/ding.mp3"),this.load.audio("forblock0","./assets/audios/forblock/block0.mp3"),this.load.audio("forblock1","./assets/audios/forblock/block1.mp3"),this.load.audio("forblock2","./assets/audios/forblock/block2.mp3"),this.load.audio("forbeam0","./assets/audios/forbeam/beam0.mp3"),this.load.audio("forbeam1","./assets/audios/forbeam/beam1.mp3"),this.load.audio("forbeam2","./assets/audios/forbeam/beam2.mp3"),this.load.audio("forboom0","./assets/audios/forboom/boom0.mp3"),this.load.audio("forboom1","./assets/audios/forboom/boom1.mp3"),this.load.audio("forboom2","./assets/audios/forboom/boom2.mp3")}create(){this.beanIndex=null!=localStorage.getItem("bean")?localStorage.getItem("bean").replace("bean",""):0,this.blockIndex=null!=localStorage.getItem("block")?localStorage.getItem("block").replace("block",""):0,this.audioIndex=null!=localStorage.getItem("audio")?localStorage.getItem("audio").replace("audio",""):0,this.langIndex=null!=localStorage.getItem("lang")?localStorage.getItem("lang"):0,this.isBgmPlay=null!=localStorage.getItem("isBgmPlay")&&JSON.parse(localStorage.getItem("isBgmPlay")),this.isSePlay=null==localStorage.getItem("isSePlay")||JSON.parse(localStorage.getItem("isSePlay")),this.gameOver=!1,this.coins=null!=localStorage.getItem("coin")?JSON.parse(localStorage.getItem("coin")):0,this.score=0,this.highestHistoryScore=localStorage.getItem("historyHighest")?localStorage.getItem("historyHighest"):0,this.gameState=0,this.specialItemKeys=Object.keys(e),this.estimationWord=Object(E[this.langIndex]),this.isFrozen=!1,this.isGreedy=!1,this.isDouble=!1,this.isBeamTime=!1,this.isBoomTime=!1,this.audioPlayer=document.querySelector(".bgm-audio"),this.isAnyModalOpen=!1,this.estimatedLevel=0,this.level=0,this.beanCount=1,this.recycledBlocks=[],this.blockSize=game.config.width/M.SHAPES_PER_LINE,this.gameFieldHeight=this.blockSize*M.SHAPES_ALL_LINES,this.emptySpace=game.config.height-this.gameFieldHeight,this.physics.world.setBounds(0,this.emptySpace/2,game.config.width,this.gameFieldHeight),this.blockGroup=this.physics.add.group(),this.beanGroup=this.physics.add.group(),this.extraBeanGroup=this.physics.add.group(),this.specialItemGroup=this.physics.add.group(),this.currentSpecialItemGroup=this.physics.add.group(),null!=localStorage.getItem("myItems")&&localStorage.getItem("myItems").split(",").forEach(((t,e)=>{let i=this.currentSpecialItemGroup.create(100*(e+1)+200,1200,t).setScale(.3).setDepth(1).setInteractive({useHandCursor:!0});i.on("pointerdown",(()=>{this.selectSpecialItem(t);let e=this.currentSpecialItemGroup.getChildren(),s=e.indexOf(i),a=e.slice(s+1,e.length);this.tweens.add({targets:a,x:"-=100",duration:300}),i.destroy()}))})),this.tweens.add({targets:this.currentSpecialItemGroup.getChildren(),y:"-=100",duration:1500,repeat:0,ease:"back.out"}),this.topPanel=this.add.sprite(game.config.width/2,0,"panel"),this.topPanel.displayWidth=game.config.width,this.topPanel.displayHeight=this.emptySpace/2,this.topPanel.setOrigin(.5,0),this.pauseButton=this.add.image(60,100,"pause").setScale(.6).setInteractive({useHandCursor:!0}),this.settingButton=this.add.image(game.config.width-60,100,"setting").setScale(.6).setInteractive({useHandCursor:!0}),this.coinExample=this.add.image(130,0,"coin").setScale(.2),this.tweens.add({targets:this.coinExample,y:100,duration:1500,repeat:0,ease:"back.out"}),this.coinText=this.add.text(160,0,x[this.langIndex],s[this.langIndex].ForTopPanelText),this.coinData=this.add.text(200,0,this.coins,s[this.langIndex].ForPanelNumber),this.scoreText=this.add.text(game.config.width-260,0,w[this.langIndex],s[this.langIndex].ForTopPanelText),this.scoreData=this.add.text(game.config.width-220,0,this.score,s[this.langIndex].ForPanelNumber),this.tweens.add({targets:[this.coinText,this.scoreText],y:80,duration:1500,repeat:0,ease:"back.out"}),this.tweens.add({targets:[this.coinData,this.scoreData],y:130,duration:1500,repeat:0,ease:"back.out"}),this.bottomPanel=this.add.sprite(game.config.width/2,game.config.height,"panel"),this.bottomPanel.displayWidth=game.config.width,this.bottomPanel.displayHeight=this.emptySpace/2,this.bottomPanel.setOrigin(.5,1),this.beanExample=this.add.image(100,game.config.height+20,"bean"+this.beanIndex).setScale(.3).setDepth(1),this.beanData=this.add.text(180,game.config.height,this.beanCount,s[this.langIndex].ForPanelNumber);let t=this.add.circle(100,game.config.height+20,48,3876896),i=this.add.circle(300,game.config.height+20,48,3876896),a=this.add.circle(400,game.config.height+20,48,3876896),o=this.add.circle(500,game.config.height+20,48,3876896);this.tweens.add({targets:[t,i,a,o,this.beanExample,this.beanData],y:"-=120",duration:1500,repeat:0,ease:"back.out"}),this.beanText=this.add.text(60,game.config.height,T[this.langIndex],s[this.langIndex].ForBottomPanelText).setDepth(2),this.itemText=this.add.text(360,game.config.height,k[this.langIndex],s[this.langIndex].ForBottomPanelText).setDepth(2),this.tweens.add({targets:[this.beanText,this.itemText],y:"-=200",duration:1500,repeat:0,ease:"back.out"}),this.ballSize=game.config.width*M.BALL_SIZE,this.trajectoryGraphics=this.add.graphics(),this.addBean(game.config.width/2,game.config.height-this.bottomPanel.displayHeight-this.ballSize/2,!1),this.shootPointGroup=this.add.group();for(let t=0;t<12;t++){let t=this.add.image(game.config.width/2,game.config.height-this.bottomPanel.displayHeight-32,"point").setScale(.1).setDepth(-1);this.shootPointGroup.add(t)}this.shootPointGroup.setVisible(!1),this.shootBoomGroup=this.add.group();for(let t=0;t<8;t++){let t=this.add.image(game.config.width/2,game.config.height-this.bottomPanel.displayHeight-32,"point").setScale(.3).setDepth(-1);this.shootBoomGroup.add(t)}this.shootBoomGroup.setVisible(!1),this.shootBeamGroup=this.add.group();for(let t=0;t<16;t++){let t=this.add.image(game.config.width/2,game.config.height-this.bottomPanel.displayHeight-32,"beampoint").setScale(.5).setDepth(-1);this.shootBeamGroup.add(t)}this.shootBeamGroup.setVisible(!1),this.addShapeLine(),this.pauseButton.on("pointerdown",(()=>{this.createOverlayMask(),this.showPauseModal()})),this.settingButton.on("pointerdown",(()=>{this.createOverlayMask(),this.showSettingModal()})),this.input.on("pointerdown",this.aimingShapes,this),this.input.on("pointerup",this.shootBean,this),this.input.on("pointermove",this.adjustShooting,this),this.input.on("dragstart",this.aimingShapes,this),this.input.on("dragend",this.shootBean,this),this.input.on("drag",this.adjustShooting,this),this.physics.world.on("worldbounds",this.checkBeanBoundCollision,this)}update(){(3==this.gameState||2==this.gameState&&this.landedBalls==this.beanGroup.getChildren().length)&&(2==this.gameState?this.gameState=3:(this.gameState=4,this.isFrozen||(this.moveBlocks(),this.moveExtraBeans(),this.moveSpecialItems()),null!=this.firstBallToLand&&this.moveBeans(),this.resetStates())),2==this.gameState&&(this.handleBeanVsShape(),this.handleBeanVsExtra(),this.handleBeanVsSpecialItem()),5==this.gameState&&this.handleBoomVsShape(),6==this.gameState&&this.handleBeamVsAll()}addShape(t,e,i,s){let a=i?this.recycledBlocks.shift():this.blockGroup.create(t,e,"block"+this.blockIndex);if(a.displayWidth=this.blockSize,a.displayHeight=this.blockSize,a.value=this.level,a.row=1,a.setTint(s),i)a.x=t,a.y=e,a.text.setText(a.value),a.text.x=a.x,a.text.y=a.y,a.setVisible(!0),a.text.setVisible(!0),this.blockGroup.add(a);else{let t=this.add.text(a.x,a.y,a.value,{font:"normal 32px Impact",align:"center",color:"#ffffff"});t.setOrigin(.5),a.text=t}a.body.immovable=!0}addBean(t,e,i){let s=i?this.extraBeanGroup.create(t,e,"bean"+this.beanIndex):this.beanGroup.create(t,e,"bean"+this.beanIndex);s.displayWidth=this.ballSize,s.displayHeight=this.ballSize,s.body.setCircle(128),s.body.setBounce(1,1),i&&(s.row=1,s.collected=!1),s.body.collideWorldBounds=!0,s.body.onWorldBounds=!0}addBoomOrBeam(t,e,i,s){i&&(this.boom=this.beanGroup.create(t,e,"item5"),this.boom.displayWidth=2*this.ballSize,this.boom.displayHeight=2*this.ballSize,this.boom.body.setCircle(128),this.boom.body.setBounce(1,1),this.boom.body.collideWorldBounds=!0,this.boom.body.onWorldBounds=!0),s&&(this.beam=this.beanGroup.create(t,e,"item4"),this.beam.displayWidth=4*this.ballSize,this.beam.displayHeight=4*this.ballSize,this.beam.body.setCircle(128),this.beam.body.setBounce(1,1),this.beam.body.collideWorldBounds=!0,this.beam.body.onWorldBounds=!0)}addSpecialItem(e,i){let s="item"+t.Math.Between(0,this.specialItemKeys.length-1),a=this.specialItemGroup.create(e,i,s);a.displayWidth=this.ballSize,a.displayHeight=this.ballSize,a.body.setCircle(128),a.body.setBounce(1,1),a.body.collideWorldBounds=!0,a.body.onWorldBounds=!0}addShapeLine(){this.level++;let e=[],i=A[Math.floor(Math.random()*A.length)],s=t.Math.Between(0,100)<M.EXTRA_BEAN_PROBABILITY,a=t.Math.Between(0,100)<M.SPECIAL_ITEM_PROBABILTIY;for(let o=0;o<M.MAX_SHAPES_NUM_PER_LINE;o++){let o=t.Math.Between(0,M.SHAPES_PER_LINE-1);-1==e.indexOf(o)&&(e.push(o),s?(s=!1,this.addBean(o*this.blockSize+this.blockSize/2,this.blockSize/2+this.emptySpace/2,!0)):a?(a=!1,this.addSpecialItem(o*this.blockSize+this.blockSize/2,this.blockSize/2+this.emptySpace/2)):0==this.recycledBlocks.length?this.addShape(o*this.blockSize+this.blockSize/2,this.blockSize/2+this.emptySpace/2,!1,i):this.addShape(o*this.blockSize+this.blockSize/2,this.blockSize/2+this.emptySpace/2,!0,i)),this.fieldSegments=[];let n=new t.Geom.Rectangle(0,this.emptySpace/2,game.config.width,this.gameFieldHeight);this.addToFieldSegments(n),t.Actions.Call(this.blockGroup.getChildren(),(function(t){let e=t.getBounds();this.addToFieldSegments(e)}),this)}}getBallPosition(){let e=this.beanGroup.getChildren();return new t.Geom.Point(e[0].x,e[0].y)}aimingShapes(){0==this.gameState&&(this.legalAngleOfFire=!1,this.gameState=1)}adjustShooting(e){1==this.gameState&&(e.y-e.downY>10?(this.legalAngleOfFire=!0,this.direction=t.Math.Angle.Between(e.x,e.y,e.downX,e.downY),this.shootPointGroup.setVisible(!0),this.tweens.addCounter({from:0,to:40,duration:1e3,repeat:-1,onUpdate:t=>{this.shootPointGroup.getChildren().forEach(((e,i)=>{let s=40*i+t.getValue();e.setPosition(this.beanGroup.getChildren()[0].x+s*Math.cos(this.direction),this.beanGroup.getChildren()[0].y+s*Math.sin(this.direction))}))}})):(this.legalAngleOfFire=!1,this.trajectoryGraphics.clear()))}adjustBoomShooting(e){1==this.gameState&&(e.y-e.downY>10?(this.legalAngleOfFire=!0,this.direction=t.Math.Angle.Between(e.x,e.y,e.downX,e.downY),this.shootBoomGroup.setVisible(!0),this.tweens.addCounter({from:0,to:60,duration:1e3,repeat:-1,onUpdate:t=>{this.shootBoomGroup.getChildren().forEach(((e,i)=>{let s=60*i+t.getValue();e.setPosition(this.beanGroup.getChildren()[0].x+s*Math.cos(this.direction),this.beanGroup.getChildren()[0].y+s*Math.sin(this.direction))}))}})):(this.legalAngleOfFire=!1,this.trajectoryGraphics.clear()))}adjustBeamShooting(e){1==this.gameState&&(e.y-e.downY>10?(this.legalAngleOfFire=!0,this.direction=t.Math.Angle.Between(e.x,e.y,e.downX,e.downY),this.shootBeamGroup.setVisible(!0),this.tweens.addCounter({from:0,to:40,duration:1e3,repeat:-1,onUpdate:t=>{this.shootBeamGroup.getChildren().forEach(((e,i)=>{let s=40*i+t.getValue();e.setPosition(this.beanGroup.getChildren()[0].x+s*Math.cos(this.direction),this.beanGroup.getChildren()[0].y+s*Math.sin(this.direction)),e.setRotation(Math.cos(this.direction))}))}})):(this.legalAngleOfFire=!1,this.trajectoryGraphics.clear()))}addToFieldSegments(t){this.fieldSegments.push(t.getLineA()),this.fieldSegments.push(t.getLineB()),this.fieldSegments.push(t.getLineC()),this.fieldSegments.push(t.getLineD())}shootBean(){1==this.gameState&&(this.trajectoryGraphics.clear(),this.shootPointGroup.setVisible(!1),this.legalAngleOfFire?(this.gameState=2,this.landedBalls=0,this.beanGroup.getChildren().forEach(function(t,e){this.time.addEvent({delay:100*e,callbackScope:this,callback:function(){t.body.setVelocity(M.BALL_SPEED*Math.cos(this.direction),M.BALL_SPEED*Math.sin(this.direction))}})}.bind(this))):this.gameState=0)}shootBoom(){1==this.gameState&&(this.trajectoryGraphics.clear(),this.shootBoomGroup.setVisible(!1),this.legalAngleOfFire?(this.gameState=5,this.time.addEvent({delay:100,callbackScope:this,callback:function(){this.boom.body.setVelocity(M.BALL_SPEED*Math.cos(this.direction),M.BALL_SPEED*Math.sin(this.direction))}})):this.gameState=0)}shootBeam(){1==this.gameState&&(this.trajectoryGraphics.clear(),this.shootBeamGroup.setVisible(!1),this.legalAngleOfFire?(this.gameState=6,this.time.addEvent({delay:100,callbackScope:this,callback:function(){this.beam.body.setVelocity(M.BALL_SPEED*Math.cos(this.direction)*2,M.BALL_SPEED*Math.sin(this.direction)*2)}})):this.gameState=0)}checkBeanBoundCollision(t,e,i,s,a){i&&2==this.gameState&&(t.setVelocity(0),this.landedBalls++,1==this.landedBalls&&(this.firstBallToLand=t))}checkBoomBoundCollision(t,e,i,s,a){(e&&5==this.gameState||s&&5==this.gameState||a&&5==this.gameState)&&(this.boom.destroy(),setTimeout((()=>{this.beanGroup.setVisible(!0),this.gameState=0,this.resetInput()}),300))}checkBeamBoundCollision(t,e,i,s,a){(e&&6==this.gameState||s&&6==this.gameState||a&&6==this.gameState)&&(this.beam.destroy(),setTimeout((()=>{this.beanGroup.setVisible(!0),this.gameState=0,this.resetInput()}),300))}moveBlocks(){this.tweens.add({targets:this.blockGroup.getChildren(),props:{y:{getEnd:function(t){return t.y+t.displayHeight}}},callbackScope:this,onUpdate:function(t,e){e.text.y=e.y},onComplete:function(){if(this.gameState=0,t.Actions.Call(this.blockGroup.getChildren(),(function(t){t.row++,t.row==M.SHAPES_ALL_LINES&&(this.gameOver=!0)}),this),this.addShapeLine(),this.gameOver){this.input.off("pointermove"),this.createOverlayMask(),this.showRestartModal(),this.score>this.highestHistoryScore&&localStorage.setItem("historyHighest",this.score),localStorage.setItem("coin",this.coins);let t=[];this.currentSpecialItemGroup.getChildren().forEach((e=>{t.push(e.texture.key)})),localStorage.setItem("myItems",t)}},duration:500,ease:"Cubic.easeInOut"})}moveBeans(){this.tweens.add({targets:this.beanGroup.getChildren(),x:this.firstBallToLand.gameObject.x,duration:300,ease:"Cubic.easeInOut"})}moveExtraBeans(){t.Actions.Call(this.extraBeanGroup.getChildren(),(function(t){t.row==M.blockLines&&(t.collected=!0)})),this.tweens.add({targets:this.extraBeanGroup.getChildren(),props:{x:{getEnd:function(t){return t.collected?t.scene.firstBallToLand.gameObject.x:t.x}},y:{getEnd:function(t){return t.collected?t.scene.firstBallToLand.gameObject.y:t.y+t.scene.blockSize}}},callbackScope:this,onComplete:function(){t.Actions.Call(this.extraBeanGroup.getChildren(),(function(t){t.collected?(this.extraBeanGroup.remove(t),this.beanGroup.add(t),t.body.collideWorldBounds=!0,t.body.onWorldBounds=!0,t.body.setBounce(1,1),this.beanCount=this.beanGroup.children.entries.length,this.beanData.text=this.beanCount):t.row++}),this)},duration:300,ease:"Cubic.easeInOut"})}moveSpecialItems(){this.tweens.add({targets:this.specialItemGroup.getChildren(),props:{x:{getEnd:function(t){return t.collected?t.scene.firstBallToLand.gameObject.x:t.x}},y:{getEnd:function(t){return t.collected?t.scene.firstBallToLand.gameObject.y:t.y+t.scene.blockSize}}},callbackScope:this,onComplete:function(){t.Actions.Call(this.specialItemGroup.getChildren(),(function(t){t.collected?this.specialItemGroup.remove(t):t.row++}),this)},duration:300,ease:"Cubic.easeInOut"})}handleBeanVsShape(){this.physics.world.collide(this.beanGroup,this.blockGroup,(function(t,e){this.isSePlay&&this.sound.play("ding"),this.isDouble?e.value-=2:e.value--,this.score+=1,e.value<=0?(this.recycledBlocks.push(e),this.blockGroup.remove(e),e.visible=!1,e.text.visible=!1,this.isSePlay&&this.sound.play("forblock"+this.audioIndex),this.coins=this.isGreedy?this.coins+2:this.coins+1,this.coinData.setText(this.coins)):e.text.setText(e.value),this.scoreData.setText(this.score)}),null,this)}handleBoomVsShape(){this.physics.world.collide(this.boom,this.blockGroup,(function(t,e){this.isSePlay&&this.sound.add("forboom"+this.audioIndex,{volume:.6}).play(),this.tweens.add({targets:t,scale:.6,duration:100,onComplete:()=>{this.score+=e.value,this.recycledBlocks.push(e),this.blockGroup.remove(e),e.visible=!1,e.text.visible=!1,this.scoreData.setText(this.score),this.coins=this.isGreedy?this.coins+2:this.coins+1,this.coinData.setText(this.coins)}})}),null,this)}handleBeamVsAll(){this.physics.world.overlap(this.beam,this.blockGroup,(function(t,e){this.isSePlay&&this.sound.add("forbeam"+this.audioIndex,{volume:.4}).play(),this.score+=e.value,this.recycledBlocks.push(e),this.blockGroup.remove(e),e.visible=!1,e.text.visible=!1,e.text.setText(e.value),this.scoreData.setText(this.score)}),null,this),this.physics.world.overlap(this.beam,this.extraBeanGroup,(function(t,e){this.extraBeanGroup.remove(e),e.destroy()}),null,this),this.physics.world.overlap(this.beam,this.specialItemGroup,(function(t,e){this.specialItemGroup.remove(e),e.destroy()}),null,this)}handleBeanVsExtra(){this.physics.world.overlap(this.beanGroup,this.extraBeanGroup,(function(t,e){e.collected=!0,this.tweens.add({targets:e,y:game.config.height-this.bottomPanel.displayHeight-e.displayHeight/2,duration:200,ease:"Cubic.easeOut"})}),null,this)}handleBeanVsSpecialItem(){this.physics.world.overlap(this.beanGroup,this.specialItemGroup,(function(t,e){let i=this.currentSpecialItemGroup.getChildren(),s=i.length;if(this.specialItemGroup.remove(e),this.currentSpecialItemGroup.add(e),e.setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.selectSpecialItem(e.texture.key);let t=this.currentSpecialItemGroup.getChildren(),i=t.indexOf(e),s=t.slice(i+1,t.length);this.tweens.add({targets:s,x:"-=100",duration:300}),this.currentSpecialItemGroup.remove(e),e.destroy()})),s<3&&(e.setPosition(100*(s+1)+200,1100,0,0),e.setScale(.3)),s>=3){e.setPosition(500,game.config.height,0,0),e.setScale(.3);let t=i.slice(0,i.length-3),s=i.slice(i.length-3,i.length-1);this.tweens.add({targets:t,y:"+=180",duration:300,onComplete:()=>{this.currentSpecialItemGroup.remove(t);for(let e of t)e.destroy()}}),this.tweens.add({targets:s,x:"-=100",duration:300}),this.tweens.add({targets:e,y:"-=100",duration:300})}}),null,this)}eraseBlockLine(){let t=this.blockGroup.getChildren(),e=[];if(this.addSpecialItemTweens("HAPPY_BE_LAZY",game.config.width/2-100,game.config.height/2,"+=80"),0!=t.length){let i=t[0].row;t.forEach((t=>{t.row===i&&e.push(t)})),e.forEach((t=>{t.destroy(),t.text.destroy()}));let s=this.add.image(0,this.emptySpace/2+this.blockSize*i-this.blockSize/2,"block"+this.blockIndex).setScale(.4).setTint(16774781);s.displayWidth=this.blockSize,s.displayHeight=this.blockSize,this.tweens.add({targets:s,x:game.config.width,duration:500,onComplete:()=>{s.destroy()}})}}greedyTime(){this.isGreedy=!0,this.coinExample.setTexture("lightcoin"),this.addSpecialItemTweens("JUST_WANT_IT",game.config.width/2-100,game.config.height/2,"+=80")}doubleShooting(){this.isDouble=!0,this.beanExample.setTexture("item2"),this.addSpecialItemTweens("DOUBLE_BEANS_RUN",game.config.width/2-180,game.config.height/2,"+=80")}freezeBlockLine(){this.isFrozen=!0,this.blockGroup.getChildren().forEach((t=>{t.setTint(6393850)})),this.addSpecialItemTweens("ALL_YOU_FROZEN",game.config.width/2-80,game.config.height/2,"+=80")}beamTime(){this.isBoomTime&&(this.isBoomTime=!1,this.boom.destroy()),this.addSpecialItemTweens("CYBER_IKUZO",game.config.width/2-200,game.config.height/2,"+=80"),this.beanGroup.setVisible(!1),this.isBeamTime=!0,this.input.off("pointermove",this.adjustShooting,this),this.input.on("pointermove",this.adjustBeamShooting,this),this.input.off("pointerup",this.shootBean,this),this.input.on("pointerup",this.shootBeam,this),this.physics.world.off("worldbounds",this.checkBeanBoundCollision,this),this.physics.world.on("worldbounds",this.checkBeamBoundCollision,this),this.firstBallTempLocate=this.beanGroup.getChildren()[0],this.addBoomOrBeam(this.firstBallTempLocate.x,this.firstBallTempLocate.y,!1,!0)}boomTime(){this.isBeamTime&&(this.isBeamTime=!1,this.beam.destroy()),this.beanGroup.setVisible(!1),this.addSpecialItemTweens("RED_TEMPER_BOMB",game.config.width/2-100,game.config.height/2,"+=80"),this.isBoomTime=!0,this.input.off("pointermove",this.adjustShooting,this),this.input.on("pointermove",this.adjustBoomShooting,this),this.input.off("pointerup",this.shootBean,this),this.input.on("pointerup",this.shootBoom,this),this.physics.world.off("worldbounds",this.checkBeanBoundCollision,this),this.physics.world.on("worldbounds",this.checkBoomBoundCollision,this),this.firstBallTempLocate=this.beanGroup.getChildren()[0],this.addBoomOrBeam(this.firstBallTempLocate.x,this.firstBallTempLocate.y,!0,!1)}pickRandomSpecialItem(){this.addSpecialItemTweens("AKAMI_MAGIC",game.config.width/2-180,game.config.height/2-120,"+=0");let e="item"+t.Math.Between(0,this.specialItemKeys.length-2);this.selectSpecialItem(e)}resetStates(){this.isFrozen=!1,this.isGreedy=!1,this.isDouble=!1,this.isBoomTime=!1,this.isBeamTime=!1,this.resetInput(),this.gameState=0,this.coinExample.setTexture("coin"),this.beanExample.setTexture("bean"+this.beanIndex)}resetInput(){this.input.off("pointermove"),this.input.off("pointerup"),this.input.on("pointermove",this.adjustShooting,this),this.input.on("pointerup",this.shootBean,this),this.physics.world.off("worldbounds"),this.physics.world.on("worldbounds",this.checkBeanBoundCollision,this)}selectSpecialItem(t){switch(t){case"item0":this.eraseBlockLine();break;case"item1":this.greedyTime();break;case"item2":this.doubleShooting();break;case"item3":this.freezeBlockLine();break;case"item4":this.beamTime();break;case"item5":this.boomTime();break;case"item6":this.pickRandomSpecialItem()}}backToHome(){this.cameras.main.fadeOut(300,0,0,0).once(t.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((t,e)=>{this.scene.stop("GamePlay"),this.scene.start("GameStart")}))}turnToShop(){this.cameras.main.fadeOut(300,0,0,0).once(t.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((t,e)=>{this.scene.stop("GamePlay"),this.scene.start("GameShop")}))}restartTheTurn(){this.cameras.main.fadeOut(300,0,0,0).once(t.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((t,e)=>{this.scene.stop("GamePlay"),this.scene.start("GamePlay")}))}createOverlayMask(){this.isAnyModalOpen||(this.enableMainElements(!1),this.overlay=this.add.graphics(),this.overlay.fillStyle(0,.3).fillRect(0,0,game.config.width,game.config.height).setDepth(3))}enableMainElements(t){this.pauseButton.input.enabled=t,this.settingButton.input.enabled=t,this.currentSpecialItemGroup.getChildren().forEach((e=>{e.input.enabled=t}))}showSettingModal(){if(!this.isAnyModalOpen){this.isAnyModalOpen=!0,this.input.off("pointermove");let e=this.isBgmPlay?"sound":"nosound",i=this.isSePlay?"sound":"nosound";this.settingModalContainer=this.add.container(0,0).setSize(400,160).setDepth(4),this.settingModalContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,160,4929584).setStrokeStyle(16,4929584);let a=this.add.text(game.config.width/2+100,game.config.height/2-100,"BGM",s[this.langIndex].ForTopPanelText);this.bgmButton=this.add.image(game.config.width/2+100,game.config.height/2-100,e).setScale(.6).setInteractive({useHandCursor:!0});let o=this.add.text(game.config.width/2+100,game.config.height/2-100,"SE",s[this.langIndex].ForTopPanelText);this.seButton=this.add.image(game.config.width/2+100,game.config.height/2-100,i).setScale(.6).setInteractive({useHandCursor:!0});let n=this.add.image(game.config.width/2+100,game.config.height/2-100,"close").setScale(.4).setInteractive({useHandCursor:!0});t.Display.Align.In.QuickSet(a,this.settingModalContent,4,-20,0),t.Display.Align.In.QuickSet(this.bgmButton,this.settingModalContent,4,-100,0),t.Display.Align.In.QuickSet(o,this.settingModalContent,8,-100,0),t.Display.Align.In.QuickSet(this.seButton,this.settingModalContent,8,-10,0),t.Display.Align.In.QuickSet(n,this.settingModalContent,2,20,20),this.settingModalContainer.add([this.settingModalContent,a,this.bgmButton,o,this.seButton,n]),n.on("pointerdown",(()=>{this.destroySettingModal()})),this.bgmButton.on("pointerdown",(()=>{this.setIsAudioPlayable("BGM",!this.isBgmPlay)})),this.seButton.on("pointerdown",(()=>{this.setIsAudioPlayable("SE",!this.isSePlay)}))}}destroySettingModal(){this.settingModalContainer&&(this.enableMainElements(!0),this.input.on("pointermove",this.adjustShooting,this),this.settingModalContainer.destroy(),this.overlay.destroy(),this.isAnyModalOpen=!1)}showPauseModal(){if(!this.isAnyModalOpen){this.isAnyModalOpen=!0,this.input.off("pointermove"),this.pauseModalContainer=this.add.container(0,0).setSize(400,200).setDepth(4),this.pauseModalContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,160,4929584).setStrokeStyle(16,4929584);let e=this.add.image(game.config.width/2+100,game.config.height/2-100,"home").setScale(.8).setInteractive({useHandCursor:!0}),i=this.add.image(game.config.width/2+100,game.config.height/2-100,"play").setScale(.8).setInteractive({useHandCursor:!0}),s=this.add.image(game.config.width/2+100,game.config.height/2-100,"restart").setScale(.8).setInteractive({useHandCursor:!0});t.Display.Align.In.QuickSet(e,this.pauseModalContent,4,-24,0),t.Display.Align.In.QuickSet(i,this.pauseModalContent,6),t.Display.Align.In.QuickSet(s,this.pauseModalContent,8,-24,0),this.pauseModalContainer.add([this.pauseModalContent,e,i,s]),i.on("pointerdown",(()=>{this.destroyPauseModal()})),e.on("pointerdown",(()=>{this.backToHome()})),s.on("pointerdown",(()=>{this.restartTheTurn()}))}}destroyPauseModal(){this.pauseModalContainer&&(this.enableMainElements(!0),this.input.on("pointermove",this.adjustShooting,this),this.pauseModalContainer.destroy(),this.overlay.destroy(),this.isAnyModalOpen=!1)}showRestartModal(){this.isAnyModalOpen=!0,this.restartModalContainer=this.add.container(0,0).setSize(400,300).setDepth(4),this.restartModalContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,300,4929584).setStrokeStyle(16,4929584),this.score>=1e4?this.estimatedLevel=1e4:this.score>=5e3&&this.score<1e4?(this.estimatedLevel=5e3,localStorage.setItem("isDarkUnlocked",!0)):this.score>=3e3&&this.score<5e3?this.estimatedLevel=3e3:this.score>=1e3&&this.score<3e3?this.estimatedLevel=1e3:this.score>=500&&this.score<1e3?this.estimatedLevel=500:this.score>=300&&this.score<500?this.estimatedLevel=300:this.score>=100&&this.score<300?this.estimatedLevel=100:this.estimatedLevel=0;let e=this.estimationWord[this.estimatedLevel],i=e[e.length*Math.random()|0],a=this.add.text(game.config.width/2+100,game.config.height/2-100,i,s[this.langIndex].ForEstimationText),o=this.add.text(game.config.width/2-120,game.config.height/2-75,C[this.langIndex],s[this.langIndex].ForEstiamtionTitle),n=this.add.text(game.config.width/2+60,game.config.height/2-75,this.score,s[this.langIndex].ForPanelNumber),h=this.add.text(game.config.width/2-120,game.config.height/2-125,P[this.langIndex],s[this.langIndex].ForEstiamtionTitle),l=this.add.text(game.config.width/2+60,game.config.height/2-125,this.highestHistoryScore,s[this.langIndex].ForPanelNumber),d=this.add.image(game.config.width/2+100,game.config.height/2-100,"home").setScale(.7).setInteractive({useHandCursor:!0}),r=this.add.image(game.config.width/2+100,game.config.height/2-100,"shop").setScale(.7).setInteractive({useHandCursor:!0}),g=this.add.image(game.config.width/2+100,game.config.height/2-100,"restart").setScale(.7).setInteractive({useHandCursor:!0});t.Display.Align.In.QuickSet(a,this.restartModalContent,6,0,10),t.Display.Align.In.QuickSet(d,this.restartModalContent,10,-30,-10),t.Display.Align.In.QuickSet(r,this.restartModalContent,11,0,-10),t.Display.Align.In.QuickSet(g,this.restartModalContent,12,-30,-10),this.restartModalContainer.add([this.restartModalContent,a,h,l,o,n,d,r,g]),d.on("pointerdown",(()=>{this.backToHome()})),r.on("pointerdown",(()=>{this.turnToShop()})),g.on("pointerdown",(()=>{this.restartTheTurn()}))}addSpecialItemTweens(t,e,a,o){try{let n=this.add.text(e,a,i[this.langIndex][t],s[this.langIndex].ForItemUsed).setStroke("#000000",16);this.tweens.add({targets:n,y:o,duration:1500,onComplete:()=>{n.destroy()}})}catch(t){console.log(t)}}setIsAudioPlayable(t,e){let i=e?"sound":"nosound";"BGM"==t&&(this.bgmButton.setTexture(i),this.isBgmPlay=e,localStorage.setItem("isBgmPlay",e),e?this.audioPlayer.play():this.audioPlayer.pause()),"SE"==t&&(this.seButton.setTexture(i),this.isSePlay=e,localStorage.setItem("isSePlay",e))}}const G=function(t){try{return t[t.length*Math.random()|0]}catch(t){return console.log(t),0}};class O extends t.Scene{constructor(){super("GameShop")}preload(){this.load.image("panel","./assets/images/panel.png"),this.load.image("table","./assets/images/table.png"),this.load.image("darktable","./assets/images/darktable.png"),this.load.image("coin","./assets/images/coin.png"),this.load.image("bean0","./assets/images/beans/bean0.png"),this.load.image("bean1","./assets/images/beans/bean1.png"),this.load.image("bean2","./assets/images/beans/bean2.png"),this.load.image("block0","./assets/images/blocks/block0.png"),this.load.image("block1","./assets/images/blocks/block1.png"),this.load.image("block2","./assets/images/blocks/block2.png"),this.load.image("item0","./assets/images/special_items/item0.png"),this.load.image("item1","./assets/images/special_items/item1.png"),this.load.image("item2","./assets/images/special_items/item2.png"),this.load.image("item3","./assets/images/special_items/item3.png"),this.load.image("item4","./assets/images/special_items/item4.png"),this.load.image("item5","./assets/images/special_items/item5.png"),this.load.image("item6","./assets/images/special_items/item6.png"),this.load.image("tencyou01","./assets/images/tencyou/minigameShopMan01.png"),this.load.image("tencyou02","./assets/images/tencyou/minigameShopMan02.png"),this.load.image("tencyou03","./assets/images/tencyou/minigameShopMan03.png"),this.load.image("tencyou04","./assets/images/tencyou/minigameShopMan04.png"),this.load.image("tencyou05","./assets/images/tencyou/minigameShopMan05.png"),this.load.image("tencyou06","./assets/images/tencyou/minigameShopMan06.png"),this.load.image("tencyouWords","./assets/images/tencyou/shopDialog.png"),this.load.image("home","./assets/images/icons/home.png"),this.load.image("play","./assets/images/icons/play.png")}create(){this.beanIndex=null!=localStorage.getItem("bean")?localStorage.getItem("bean").replace("bean",""):0,this.blockIndex=null!=localStorage.getItem("block")?localStorage.getItem("block").replace("block",""):0,this.audioIndex=null!=localStorage.getItem("audio")?localStorage.getItem("audio").replace("audio",""):0,this.langIndex=null!=localStorage.getItem("lang")?localStorage.getItem("lang"):0,this.isBgmPlay=null==localStorage.getItem("isBgmPlay")||localStorage.getItem("isBgmPlay"),this.isSePlay=null==localStorage.getItem("isSePlay")||localStorage.getItem("isSePlay"),this.isDarkUnlocked=!!localStorage.getItem("isDarkUnlocked")&&JSON.parse(localStorage.getItem("isDarkUnlocked")),this.specialItemKeys=Object.keys(e),this.lightMerchantClickTimes=0,this.darkMerchantClickTimes=0,this.isTweenLocked=!0,this.lightShopTitle=l[this.langIndex],this.darkShopTitle=d[this.langIndex],this.itemNames=B[this.langIndex],this.blockSize=game.config.width/M.SHAPES_PER_LINE,this.gameFieldHeight=this.blockSize*M.SHAPES_ALL_LINES,this.emptySpace=game.config.height-this.gameFieldHeight,this.singleItemPrice=100,this.singlePowerPrice=1e3;let t=G(p[this.langIndex]),i=G(u[this.langIndex]);this.coins=null!=localStorage.getItem("coin")?localStorage.getItem("coin"):1e3,this.currentSpecialItems=[],this.currentSpecialItemGroup=this.add.group(),null!=localStorage.getItem("myItems")&&localStorage.getItem("myItems").split(",").forEach(((t,e)=>{this.currentSpecialItemGroup.create(150*(e+1),1100,t).setScale(.4).setDepth(1)})),this.lightTopShopPanel=this.add.image(game.config.width/2,0,"panel"),this.lightTopShopPanel.displayWidth=game.config.width,this.lightTopShopPanel.displayHeight=this.emptySpace/2,this.lightTopShopPanel.setOrigin(.5,0),this.darkTopShopPanel=this.add.image(game.config.width/2-game.config.width,0,"panel"),this.darkTopShopPanel.displayWidth=game.config.width,this.darkTopShopPanel.displayHeight=this.emptySpace/2,this.darkTopShopPanel.setOrigin(.5,0),this.darkTopShopPanel.setTint(0),this.lightBottomShopPanel=this.add.image(game.config.width/2,game.config.height,"table"),this.lightBottomShopPanel.displayWidth=game.config.width,this.lightBottomShopPanel.displayHeight=this.emptySpace/2,this.lightBottomShopPanel.setOrigin(.5,1),this.darkBottomShopPanel=this.add.image(game.config.width/2-game.config.width,game.config.height,"darktable"),this.darkBottomShopPanel.displayWidth=game.config.width,this.darkBottomShopPanel.displayHeight=this.emptySpace/2,this.darkBottomShopPanel.setOrigin(.5,1),this.backToStartButton=this.add.image(80,100,"home").setScale(.6).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.backToHome()})),this.toNewTurnButton=this.add.image(game.config.width-80,100,"play").setScale(.6).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.playNewTurn()})),this.toShopCoinsExample=this.add.image(210,0,"coin").setScale(.2),this.addSingleTweens(this.toShopCoinsExample,"+=0",100,1500,0,"back.out"),this.toShopCoinsText=this.add.text(250,0,x[this.langIndex],s[this.langIndex].ForTopPanelText),this.toShopCoinsData=this.add.text(360,0,this.coins,s[this.langIndex].ForPanelNumber),this.tweens.add({targets:[this.toShopCoinsText,this.toShopCoinsData],y:80,duration:1500,repeat:0,ease:"back.out"}),this.shopTitleText=this.add.text(40,160,this.lightShopTitle,s[this.langIndex].ForShopTitleAfter).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.shopTitleText.setStyle(s[this.langIndex].ForShopTitleAfter),this.darkShopTitleText.setStyle(s[this.langIndex].ForShopTitleBefore),this.turnToTheOtherMarket(!1)})),0==this.isDarkUnlocked?this.darkShopTitleText=this.add.text(game.config.width-280,160,"?******?",s[this.langIndex].ForShopTitleBefore):this.darkShopTitleText=this.add.text(game.config.width-280,160,this.darkShopTitle,s[this.langIndex].ForShopTitleBefore).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.darkShopTitleText.setStyle(s[this.langIndex].ForShopTitleAfter),this.shopTitleText.setStyle(s[this.langIndex].ForShopTitleBefore),this.turnToTheOtherMarket(!0)})),this.hangText=this.add.text(40,240,r[this.langIndex],s[this.langIndex].ForHangWords),this.darkhangText=this.add.text(40-game.config.width,240,g[this.langIndex],s[this.langIndex].ForHangWords),this.goodItems=[],this.goodPrices=[],this.displayItems=[],this.powerPrices=[],this.bgCircles=[];for(let t=0;t<this.specialItemKeys.length-1;t++){let e=t%3+1,i=(t-e+1)/3+1;this.goodItems[t]=this.add.text(160*e-90,200*i+210,this.itemNames[t],s[this.langIndex].ForShopText),this.goodPrices[t]=this.add.text(150*e-25,200*i+250,this.singleItemPrice,s[this.langIndex].ForShopNumber),this.displayItems[t]=this.add.image(150*e,200*i+150,"item"+t).setScale(.4).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.purchaseTheSpecialItemInLight(t)})),t<3&&(this.bgCircles[t]=this.add.circle(150*e,game.config.height-100,56,"0x3b2820"))}this.lightBeanMerchant=this.add.image(game.config.width-80,game.config.height-220,"tencyou01").setInteractive({useHandCursor:!0}).setOrigin(1).setDepth(-1).on("pointerdown",(()=>{this.merchantSayWords()})),this.lightBeanMerchant.displayHeight=240,this.lightBeanMerchant.displayWidth=240,this.tweens.add({targets:this.lightBeanMerchant,scaleY:.49,duration:1e3,yoyo:!0,repeat:-1}),this.lightBeanMerchantDialog=this.add.image(150,game.config.height-360,"tencyouWords").setInteractive({useHandCursor:!0}),this.lightBeanMerchantDialog.displayHeight=240,this.lightBeanMerchantDialog.displayWidth=300,this.lightBeanMerchantWord=this.add.text(36,game.config.height-420,t,s[this.langIndex].ForMerchantWords).setPadding(12),this.itemPurchaseText=this.add.text(40,game.config.height-220,c[this.langIndex],s[this.langIndex].ForBottomPanelText).setPadding(12),this.darkBeanMerchant=this.add.image(280-game.config.width,game.config.height-220,"tencyou05").setInteractive({useHandCursor:!0}).setOrigin(1).setDepth(-1).on("pointerdown",(()=>{this.darkMerchantSayWords()})),this.darkBeanMerchant.displayHeight=240,this.darkBeanMerchant.displayWidth=240,this.tweens.add({targets:this.darkBeanMerchant,scaleY:.49,duration:1e3,yoyo:!0,repeat:-1}),this.darkBeanMerchantDialog=this.add.image(game.config.width-180-game.config.width,game.config.height-360,"tencyouWords").setFlipX(!0),this.darkBeanMerchantDialog.displayHeight=240,this.darkBeanMerchantDialog.displayWidth=300,this.darkBeanMerchantWord=this.add.text(game.config.width-260-game.config.width,game.config.height-420,i,s[this.langIndex].ForMerchantWords).setPadding(12),this.darkPowerPurchaseText1=this.add.text(20-game.config.width,game.config.height-220,m[this.langIndex][0],s[this.langIndex].ForBottomPanelText).setPadding(12),this.darkPowerPurchaseText2=this.add.text(200-game.config.width,game.config.height-220,m[this.langIndex][1],s[this.langIndex].ForBottomPanelText).setPadding(12),this.darkPowerPurchaseText3=this.add.text(380-game.config.width,game.config.height-220,m[this.langIndex][2],s[this.langIndex].ForBottomPanelText).setPadding(12),this.darkBgCircles=[],this.displayBeans=[],this.displayBlocks=[],this.displayAudios=[],this.displayTexts=[];for(let t=0;t<9;t++){let e=t%3+1,i=(t-e+1)/3+1;t<3&&(this.darkBgCircles[t]=this.add.circle(150*(t+1)-game.config.width,game.config.height-100,56,"0x3b2820"),this.displayBeans[t]=this.add.image(150*(t+1)-game.config.width,340,"bean"+t).setScale(.3).setDepth(1).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.purchaseTheSpecialItemInDark("bean"+t)})),this.displayBlocks[t]=this.add.image(150*(t+1)-game.config.width,490,"block"+t).setScale(.3).setDepth(1).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.purchaseTheSpecialItemInDark("block"+t)})),0==this.langIndex&&(this.displayAudios[t]=this.add.text(150*(t+1)-40-game.config.width,620,I[t],s[this.langIndex].ForAudioDisplay).setDepth(1).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.purchaseTheSpecialItemInDark("audio"+t)})))),(0==this.langIndex||t<6)&&(this.displayTexts[t]=this.add.text(150*e-40-game.config.width,150*i+230,this.singlePowerPrice,s[this.langIndex].ForShopNumber))}if(this.boughtTags=[],!localStorage.getItem("boughtPowers")){let t=["bean0","block0","audio0"];localStorage.setItem("boughtPowers",JSON.stringify(t))}let a=localStorage.getItem("boughtPowers")?JSON.parse(localStorage.getItem("boughtPowers")):[];if(0!=a.length)for(let t=0;t<a.length;t++){let e,i,s,o=a[t];o.includes("bean")&&(e=JSON.parse(o.replace("bean","")),i=150*(e+1)+20-game.config.width,s=380,this.boughtTags[t]=this.add.text(i,s,"GOT!",{fontFamily:"Arial",fontSize:28}).setDepth(2).setStroke("#FFBC02",6)),o.includes("block")&&(e=JSON.parse(o.replace("block","")),i=150*(e+1)+20-game.config.width,s=530,this.boughtTags[t]=this.add.text(i,s,"GOT!",{fontFamily:"Arial",fontSize:28}).setDepth(2).setStroke("#FFBC02",6)),o.includes("audio")&&0==this.langIndex&&(e=JSON.parse(o.replace("audio","")),i=150*(e+1)+20-game.config.width,s=680,this.boughtTags[t]=this.add.text(i,s,"GOT!",{fontFamily:"Arial",fontSize:28}).setDepth(2).setStroke("#FFBC02",6))}this.beanPower=this.add.image(150-game.config.width,game.config.height-100,"bean"+this.blockIndex).setScale(.3).setDepth(1),this.blockPower=this.add.image(300-game.config.width,game.config.height-100,"block"+this.blockIndex).setScale(.3).setDepth(1),0==this.langIndex?this.audioPower=this.add.text(410-game.config.width,game.config.height-140,I[this.audioIndex],s[this.langIndex].ForAudioDisplay):this.audioPower=this.add.text(420-game.config.width,game.config.height-120,"???",s[this.langIndex].ForBottomPanelText)}update(){}backToHome(){this.cameras.main.fadeOut(300,0,0,0).once(t.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((t,e)=>{this.scene.stop("GameShop"),this.scene.start("GameStart")}))}playNewTurn(){this.cameras.main.fadeOut(300,0,0,0).once(t.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((t,e)=>{this.scene.stop("GameShop"),this.scene.start("GamePlay")}))}purchaseTheSpecialItemInLight(t){if(this.coins<100)this.lightBeanMerchantWord.setText(S[this.langIndex]);else{this.coins-=100,this.toShopCoinsData.setText(this.coins);let e="item"+t,i=this.currentSpecialItemGroup.getChildren().length;if(i<3&&this.currentSpecialItemGroup.create(150*(i+1),1100,e).setScale(.4).setDepth(1),3==i){let t=this.currentSpecialItemGroup.create(150*i,game.config.height,e).setScale(.4).setDepth(1),s=this.currentSpecialItemGroup.getChildren(),a=s[0],o=s.slice(1,s.length-1);this.tweens.add({targets:a,y:"+=100",duration:300,onComplete:()=>{this.currentSpecialItemGroup.remove(a),a.destroy()}}),this.tweens.add({targets:o,x:"-=150",duration:300}),this.tweens.add({targets:t,y:"-=100",duration:300})}let s=this.currentSpecialItemGroup.getChildren(),a=[];s.forEach((t=>{a.push(t.texture.key)})),a.length<4?localStorage.setItem("myItems",a):localStorage.setItem("myItems",a.slice(1,a.length))}}purchaseTheSpecialItemInDark(t){if(this.coins<1e3)this.darkBeanMerchantWord.setText(b[this.langIndex]);else{let e=localStorage.getItem("boughtPowers")?JSON.parse(localStorage.getItem("boughtPowers")):[];if(-1==e.indexOf(t)&&(this.coins-=1e3,this.toShopCoinsData.setText(this.coins),e.push(t),localStorage.setItem("boughtPowers",JSON.stringify(e))),t.includes("bean")&&(localStorage.setItem("bean",t),this.beanPower.setTexture(t)),t.includes("block")&&(localStorage.setItem("block",t),this.blockPower.setTexture(t)),t.includes("audio")){localStorage.setItem("audio",t);let e=t.replace("audio","");this.audioPower.setText(I[e])}}}merchantSayWords(){if(this.lightMerchantClickTimes>20)this.lightBeanMerchant.setTexture("tencyou04"),this.lightBeanMerchantWord.setText(y[this.langIndex]);else{let t=G(p[this.langIndex]);this.lightBeanMerchantWord.setText(t),this.lightMerchantClickTimes++;let e="tencyou0"+(Math.floor(3*Math.random())+1);this.lightBeanMerchant.setTexture(e)}}darkMerchantSayWords(){if(this.darkMerchantClickTimes>20)this.darkBeanMerchant.setTexture("tencyou06"),this.darkBeanMerchantWord.setText(f[this.langIndex]);else{let t=G(u[this.langIndex]);this.darkBeanMerchantWord.setText(t),this.darkMerchantClickTimes++}}turnToTheOtherMarket(t){let e=[this.darkBeanMerchant,this.darkBeanMerchantDialog,this.darkBeanMerchantWord,this.darkPowerPurchaseText1,this.darkPowerPurchaseText2,this.darkPowerPurchaseText3,this.darkTopShopPanel,this.darkBottomShopPanel,this.darkhangText,this.beanPower,this.blockPower,this.audioPower,this.powerPrices,this.lightBeanMerchant,this.lightBeanMerchantDialog,this.lightBeanMerchantWord,this.lightTopShopPanel,this.lightBottomShopPanel,this.itemPurchaseText,this.hangText,this.currentSpecialItemGroup.getChildren(),this.bgCircles,this.darkBgCircles,this.displayBeans,this.displayBlocks,this.displayAudios,this.displayTexts,this.displayItems,this.goodItems,this.goodPrices,this.boughtTags],i=[].concat(...e);t&&this.isTweenLocked&&this.tweens.add({targets:i,x:"+=600",duration:1500,ease:"Power4",onComplete:()=>{this.isTweenLocked=!1}}),t||this.isTweenLocked||this.tweens.add({targets:i,x:"-=600",duration:1500,ease:"Power4",onComplete:()=>{this.isTweenLocked=!0}})}addSingleTweens(t,e,i,s,a,o){this.tweens.add({targets:t,x:e,y:i,duration:s,repeat:a,ease:o})}}class _ extends t.GameObjects.Image{constructor(t,e,i,s,a){super(t,e,i,s),this.setInteractive({useHandCursor:!0}),t.add.existing(this)}}class v extends t.Scene{constructor(){super("GameStart")}preload(){this.load.image("gametitle0","./assets/images/minigametitle0.png"),this.load.image("gametitle1","./assets/images/minigametitle1.png"),this.load.image("gametitle2","./assets/images/minigametitle2.png"),this.load.image("panel","./assets/images/panel.png"),this.load.image("play","./assets/images/icons/play.png"),this.load.image("shop","./assets/images/icons/shop.png"),this.load.image("setting","./assets/images/icons/setting.png"),this.load.image("close","./assets/images/icons/close.png"),this.load.image("sound","./assets/images/icons/sound.png"),this.load.image("nosound","./assets/images/icons/nosound.png"),this.load.audio("bgm","./assets/audios/bgm.mp3")}create(){this.langIndex=null!=localStorage.getItem("lang")?localStorage.getItem("lang"):0,this.isBgmPlay=null!=localStorage.getItem("isBgmPlay")&&JSON.parse(localStorage.getItem("isBgmPlay")),this.isSePlay=null==localStorage.getItem("isSePlay")||JSON.parse(localStorage.getItem("isSePlay")),this.audioPlayer=document.querySelector(".bgm-audio"),this.isBgmPlay&&this.audioPlayer.play(),this.isAnyModalOpen=!1,this.blockSize=game.config.width/M.SHAPES_PER_LINE,this.gameFieldHeight=this.blockSize*M.SHAPES_ALL_LINES,this.emptySpace=game.config.height-this.gameFieldHeight,this.topPanel=this.add.image(game.config.width/2,0,"panel"),this.topPanel.displayWidth=game.config.width,this.topPanel.displayHeight=this.emptySpace/2,this.topPanel.setOrigin(.5,0),this.bottomPanel=this.add.image(game.config.width/2,game.config.height,"panel"),this.bottomPanel.displayWidth=game.config.width,this.bottomPanel.displayHeight=this.emptySpace/2,this.bottomPanel.setOrigin(.5,1),this.gameTitle=this.add.image(game.config.width/2,0,"gametitle"+this.langIndex).setDepth(1),this.tweens.add({targets:this.gameTitle,y:450,duration:1e3,repeat:0,ease:"back.out"}),this.playButton=new _(this,140,0,"play",null),this.shopButton=new _(this,300,0,"shop",null),this.settingButton=new _(this,460,0,"setting",null),this.tweens.add({targets:[this.playButton,this.shopButton,this.settingButton],y:700,duration:1e3,repeat:0,ease:"back.out"}),this.langSetButton=this.add.text(40,40,a[this.langIndex],s[this.langIndex].ForTopPanelText).setPadding(24).setInteractive({useHandCursor:!0}),this.aboutusButton=this.add.text(game.config.width-40-200,40,n[this.langIndex],s[this.langIndex].ForTopPanelText).setPadding(24).setInteractive({useHandCursor:!0}),this.playButton.on("pointerdown",(()=>{this.tweens.add({targets:this.playButton,y:"+=20",duration:100,yoyo:!0,repeat:0,onComplete:()=>{this.startNewTurn()}})})),this.shopButton.on("pointerdown",(()=>{this.tweens.add({targets:this.shopButton,y:"+=20",duration:100,yoyo:!0,repeat:0,onComplete:()=>{this.goItemShopping()}})})),this.settingButton.on("pointerdown",(()=>{this.tweens.add({targets:this.settingButton,y:"+=20",duration:100,yoyo:!0,repeat:0,onComplete:()=>{this.createOverlayMask(),this.showSettingsModal()}})})),this.langSetButton.on("pointerdown",(()=>{this.createOverlayMask(),this.showLangOptionModal()})),this.langSetButton.on("pointerover",(()=>{this.langSetButton.setBackgroundColor("#3b2820")})).on("pointerout",(()=>{this.langSetButton.setBackgroundColor("#4b3830")})),this.aboutusButton.on("pointerdown",(()=>{this.createOverlayMask(),this.showAboutusModal()})),this.aboutusButton.on("pointerover",(()=>{this.aboutusButton.setBackgroundColor("#3b2820")})).on("pointerout",(()=>{this.aboutusButton.setBackgroundColor("#4b3830")}))}update(){}startNewTurn(){this.cameras.main.fadeOut(300,0,0,0).once(t.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((t,e)=>{this.scene.stop("GameStart"),this.scene.start("GamePlay")}))}goItemShopping(){this.cameras.main.fadeOut(300,0,0,0).once(t.Cameras.Scene2D.Events.FADE_OUT_COMPLETE,((t,e)=>{this.scene.stop("GameStart"),this.scene.start("GameShop")}))}enableMainButtons(t){this.aboutusButton.input.enabled=t,this.langSetButton.input.enabled=t,this.playButton.input.enabled=t,this.shopButton.input.enabled=t,this.settingButton.input.enabled=t}createOverlayMask(){this.isAnyModalOpen||(this.enableMainButtons(!1),this.overlay=this.add.graphics(),this.overlay.fillStyle(0,.3).fillRect(0,0,game.config.width,game.config.height).setDepth(1))}showAboutusModal(){if(!this.isAnyModalOpen){this.isAnyModalOpen=!0,this.aboutUsContainer=this.add.container(0,0).setSize(400,120),this.aboutUsContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,120,4929584).setStrokeStyle(16,4929584);let e=this.add.text(game.config.width/2-200,game.config.height/2,h[this.langIndex],s[this.langIndex].ForAboutusText),i=this.add.image(game.config.width/2+100,game.config.height/2-100,"close").setScale(.4).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.destroyAboutUsModal()}));t.Display.Align.In.QuickSet(i,this.aboutUsContent,2,24,24),t.Display.Align.In.QuickSet(e,this.aboutUsContent,6,0,0),this.aboutUsContainer.add([this.aboutUsContent,e,i]).setDepth(1)}}showLangOptionModal(){if(!this.isAnyModalOpen){this.isAnyModalOpen=!0,this.langContainer=this.add.container(0,0).setSize(400,160),this.langContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,160,4929584).setStrokeStyle(16,4929584);let e=this.add.text(game.config.width/2-100,game.config.height/2,o[this.langIndex][0],s[this.langIndex].ForTopPanelText).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{localStorage.setItem("lang",0),this.scene.start("GameStart")})),i=this.add.text(game.config.width/2,game.config.height/2,o[this.langIndex][1],s[this.langIndex].ForTopPanelText).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{localStorage.setItem("lang",1),this.scene.start("GameStart")})),a=this.add.text(game.config.width/2+100,game.config.height/2,o[this.langIndex][2],s[this.langIndex].ForTopPanelText).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{localStorage.setItem("lang",2),this.scene.start("GameStart")})),n=this.add.image(game.config.width/2+100,game.config.height/2-100,"close").setScale(.4).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.destroyLangOptionModal()}));t.Display.Align.In.QuickSet(n,this.langContent,2,24,24),t.Display.Align.In.QuickSet(e,this.langContent,4,-20,0),t.Display.Align.In.QuickSet(i,this.langContent,6,0,0),t.Display.Align.In.QuickSet(a,this.langContent,8,-20,0),this.langContainer.add([this.langContent,e,i,a,n]).setDepth(1)}}showSettingsModal(){if(!this.isAnyModalOpen){this.isAnyModalOpen=!0,this.settingContainer=this.add.container(0,0).setSize(400,160),this.settingContent=this.add.rectangle(game.config.width/2,game.config.height/2,400,160,4929584).setStrokeStyle(16,4929584);let e=this.isBgmPlay?"sound":"nosound",i=this.isSePlay?"sound":"nosound",a=this.add.text(game.config.width/2+100,game.config.height/2-100,"BGM",s[this.langIndex].ForTopPanelText);this.bgmButton=this.add.image(game.config.width/2+100,game.config.height/2-100,e).setScale(.6).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.setIsAudioPlayable("BGM",!this.isBgmPlay)}));let o=this.add.text(game.config.width/2+100,game.config.height/2-100,"SE",s[this.langIndex].ForTopPanelText);this.seButton=this.add.image(game.config.width/2+100,game.config.height/2-100,i).setScale(.6).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.setIsAudioPlayable("SE",!this.isSePlay)}));let n=this.add.image(game.config.width/2+100,game.config.height/2-100,"close").setScale(.4).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>{this.destroySettingModal()}));t.Display.Align.In.QuickSet(a,this.settingContent,4,-20,0),t.Display.Align.In.QuickSet(this.bgmButton,this.settingContent,4,-100,0),t.Display.Align.In.QuickSet(o,this.settingContent,8,-100,0),t.Display.Align.In.QuickSet(this.seButton,this.settingContent,8,-10,0),t.Display.Align.In.QuickSet(n,this.settingContent,2,20,20),this.settingContainer.add([this.settingContent,a,this.bgmButton,o,this.seButton,n]).setDepth(1)}}destroyLangOptionModal(){this.langContainer&&(this.enableMainButtons(!0),this.langContainer.destroy(),this.overlay.destroy(),this.isAnyModalOpen=!1)}destroyAboutUsModal(){this.aboutUsContainer&&(this.enableMainButtons(!0),this.aboutUsContainer.destroy(),this.overlay.destroy(),this.isAnyModalOpen=!1)}destroySettingModal(){this.settingContainer&&(this.enableMainButtons(!0),this.settingContainer.destroy(),this.overlay.destroy(),this.isAnyModalOpen=!1)}setIsAudioPlayable(t,e){let i=e?"sound":"nosound";"BGM"==t&&(this.bgmButton.setTexture(i),this.isBgmPlay=e,localStorage.setItem("isBgmPlay",e),e?this.audioPlayer.play():this.audioPlayer.pause()),"SE"==t&&(this.seButton.setTexture(i),this.isSePlay=e,localStorage.setItem("isSePlay",e))}}const D={type:t.AUTO,backgroundColor:"#3b2826",scale:{mode:t.Scale.FIT,autoCenter:t.Scale.CENTER_BOTH,width:600,height:1200,fullscreenTarget:"bean-game"},physics:{default:"arcade",arcade:{debug:!1}},parent:"bean-game",scene:[v,O,F],title:"Yellow Bean Bean",version:"1.0.0",url:"",banner:{text:"#ffffff",background:["#000000","#ffcb30"],hidePhaser:!1}};window.addEventListener("load",(()=>{const e=new t.Game(D);window.game=e}))})();
